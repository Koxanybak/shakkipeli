(this["webpackJsonpshakki-frontend"]=this["webpackJsonpshakki-frontend"]||[]).push([[0],{125:function(e,a,t){e.exports=t.p+"static/media/blackking.66e1bcad.svg"},126:function(e,a,t){e.exports=t.p+"static/media/blackqueen.7b3e33e4.svg"},127:function(e,a,t){e.exports=t.p+"static/media/blackrook.96872a66.svg"},128:function(e,a,t){e.exports=t.p+"static/media/blackbishop.1f3b8d1a.svg"},129:function(e,a,t){e.exports=t.p+"static/media/blackknight.d39f1d02.svg"},130:function(e,a,t){e.exports=t.p+"static/media/blackpawn.1c52d8c4.svg"},131:function(e,a,t){e.exports=t.p+"static/media/whiteking.250510ff.svg"},132:function(e,a,t){e.exports=t.p+"static/media/whitequeen.4320a2dd.svg"},133:function(e,a,t){e.exports=t.p+"static/media/whiterook.095b1a06.svg"},134:function(e,a,t){e.exports=t.p+"static/media/whitebishop.09004fd2.svg"},135:function(e,a,t){e.exports=t.p+"static/media/whiteknight.e6294efe.svg"},136:function(e,a,t){e.exports=t.p+"static/media/whitepawn.d69014fb.svg"},152:function(e,a,t){e.exports=t(173)},173:function(e,a,t){"use strict";t.r(a);var n=t(41),r=t(0),o=t.n(r),i=t(19),c=t.n(i),l=t(50),s=t(58),u=function(){return o.a.createElement("div",null,"Student project for Full Stack open 2020")},d=t(15),m=t(210),g=t(203),p=t(211),b=t(205),v=t(30),f=t(21);function k(){var e=Object(v.a)(["\n  mutation addUser($user: NewUserInput!) {\n    addUser(\n      user: $user\n    ) {\n      username\n      tag\n      id\n      friends {\n        tag\n      }\n    }\n  }\n"]);return k=function(){return e},e}function h(){var e=Object(v.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(\n      username: $username,\n      password: $password\n    ) {\n      username\n      tag\n      friends {\n        tag\n      }\n      token\n      guest\n      id\n    }\n  }\n"]);return h=function(){return e},e}function E(){var e=Object(v.a)(["\n  query getLoggedUser($token: String) {\n    getLoggedUser(\n      token: $token\n    ) {\n      username\n      tag\n      friends {\n        tag\n      }\n      id\n      token\n      guest\n    }\n  }\n"]);return E=function(){return e},e}function j(){var e=Object(v.a)(["\n  mutation createGame {\n    createGame {\n      board {\n        type\n        side\n      }\n      id\n    }\n  }\n"]);return j=function(){return e},e}function w(){var e=Object(v.a)(["\n  mutation makeMove($move: MoveInput!) {\n    makeMove(\n      move: $move\n    ) {\n      lastMove {\n        success\n        message\n      }\n    }\n  }\n"]);return w=function(){return e},e}function O(){var e=Object(v.a)(["\n  mutation promote($gameId: String!, $pieceType: String!) {\n    promote(\n      gameId: $gameId,\n      pieceType: $pieceType\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return O=function(){return e},e}function y(){var e=Object(v.a)(["\n  mutation joinGame($gameId: String!) {\n    joinGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function S(){var e=Object(v.a)(["\n  subscription gameStateUpdated($gameId: String!) {\n    gameStateUpdated(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return S=function(){return e},e}function L(){var e=Object(v.a)(["\n  query getGame($gameId: String!) {\n    getGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return L=function(){return e},e}function M(){var e=Object(v.a)(["\n  fragment gameStateDetails on Game {\n    board {\n        ...idlePiece\n        availableMoves {\n          newLocation {\n            ...location\n          }\n        }\n      }\n      id\n      currentPlayer\n      whitePlayer\n      blackPlayer\n      winner\n      gameOver\n      promotionPlayerID\n      check {\n        threatenedPlayer\n        movesAvailable {\n          piece {\n            ...idlePiece\n          }\n          newLocation {\n            ...location\n          }\n        }\n      }\n  }\n  ","\n  ","\n"]);return M=function(){return e},e}function x(){var e=Object(v.a)(["\n fragment moveHistoryEntry on MoveHistoryEntry {\n   leadToCheck\n   wonTheGame\n }\n"]);return x=function(){return e},e}function I(){var e=Object(v.a)(["\n  fragment movedPiece on Piece {\n    type\n    side\n    id\n    lastLocation {\n      ...location\n    }\n  }\n  ","\n"]);return I=function(){return e},e}function N(){var e=Object(v.a)(["\n  fragment idlePiece on Piece {\n    type\n    side\n    id\n    location {\n      ...location\n    }\n  }\n  ","\n"]);return N=function(){return e},e}function P(){var e=Object(v.a)(["\n  fragment location on Location {\n    row\n    column\n  }\n"]);return P=function(){return e},e}var q,C,D=Object(f.a)(P()),U=Object(f.a)(N(),D),T=(Object(f.a)(I(),D),Object(f.a)(x()),Object(f.a)(M(),D,U)),$=Object(f.a)(L(),T),Q=Object(f.a)(S(),T),G=Object(f.a)(y(),T),A=Object(f.a)(O(),T),K=Object(f.a)(w()),H=Object(f.a)(j()),J=Object(f.a)(E()),B=Object(f.a)(h()),R=Object(f.a)(k()),V=t(117),z=t(113),F=t(114),W=t(118),X=t(115),Y=function(e){e.graphQLErrors&&e.graphQLErrors[0]?(console.log(e.graphQLErrors[0].message),e.graphQLErrors[0].stack&&console.log(e.graphQLErrors[0].stack)):(console.log(e.message),e.stack&&console.log(e.stack))},Z=function(){var e=Object(z.a)(),a=Object(r.useState)(null),t=Object(d.a)(a,2),n=t[0],o=t[1],i=Object(X.a)(J,{variables:{token:window.localStorage.getItem("loggedChessUser")?window.localStorage.getItem("loggedChessUser"):window.sessionStorage.getItem("loggedChessUser")},onCompleted:function(e){p(e.getLoggedUser)},onError:function(e){Y(e)}}),c=Object(d.a)(i,1)[0],l=Object(F.a)(J,{variables:{token:window.localStorage.getItem("loggedChessUser")?window.localStorage.getItem("loggedChessUser"):window.sessionStorage.getItem("loggedChessUser")},onError:function(e){Y(e)}}),s=l.loading,u=l.data,m=l.error,g=Object(r.useCallback)((function(){console.log("logged out"),window.localStorage.removeItem("loggedChessUser"),window.sessionStorage.removeItem("loggedChessUser"),o(null),c()}),[c]),p=Object(r.useCallback)((function(a,t){var n={getLoggedUser:a};t&&(console.log("localStorageen meni"),window.localStorage.setItem("loggedChessUser",a.token)),window.sessionStorage.setItem("loggedChessUser",a.token),e.writeQuery({query:J,data:n,variables:{token:a.token}})}),[e]);Object(r.useEffect)((function(){u&&(p(u.getLoggedUser),o(u.getLoggedUser.token))}),[u,p]);var b=null;return s||m||!n||(b=e.readQuery({query:J,variables:{token:n}})),{user:s||m||!n?null:b.getLoggedUser,userLoading:s,userError:m,setUser:p,removeUser:g}},_=function(){var e=Object(r.useState)(""),a=Object(d.a)(e,2),t=a[0],n=a[1],i=Object(r.useState)(""),c=Object(d.a)(i,2),l=c[0],u=c[1],v=Object(r.useState)(!0),f=Object(d.a)(v,2),k=f[0],h=f[1],E=Z().setUser,j=Object(s.f)(),w=Object(V.a)(B,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message),u("")}}),O=Object(d.a)(w,2),y=O[0],S=O[1];return Object(r.useEffect)((function(){S.data&&(n(""),u(""),E(S.data.login,k),j.push("/"))}),[S.data,E,j,k]),o.a.createElement("div",null,o.a.createElement("h2",null,"Kirjaudu sis\xe4\xe4n"),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),y({variables:{username:t,password:l}})}},o.a.createElement("div",null,o.a.createElement(m.a,{label:"K\xe4ytt\xe4j\xe4nimi",onChange:function(e){n(e.target.value)},name:"username"})),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Salasana",type:"password",onChange:function(e){u(e.target.value)},name:"password"})),o.a.createElement("div",null,o.a.createElement(g.a,{control:o.a.createElement(p.a,{checked:k,onChange:function(){return h(!k)},name:"rememberMe",color:"primary"}),label:"Muista minut"})),o.a.createElement("div",null,o.a.createElement(b.a,{variant:"contained",color:"primary",type:"submit"},"Kirjaudu"))),o.a.createElement("div",null,"tai"),o.a.createElement("div",null,o.a.createElement(b.a,{variant:"contained",color:"primary",onClick:function(){return j.push("/register")}},"Luo uusi k\xe4ytt\xe4j\xe4")))},ee=t(206),ae=t(207),te=t(204),ne=function(){var e=Z();e.user,e.removeUser;return o.a.createElement(ee.a,{position:"static"},o.a.createElement(ae.a,null,o.a.createElement(te.a,{edge:"start",color:"inherit","aria-label":"menu"}),o.a.createElement(b.a,{color:"inherit",component:l.b,to:"/play"},"Pelaa"),o.a.createElement(b.a,{color:"inherit",component:l.b,to:"/info"},"Ohjeet")))},re=function(){var e=Object(r.useState)(""),a=Object(d.a)(e,2),t=a[0],n=a[1],i=Object(r.useState)(""),c=Object(d.a)(i,2),l=c[0],u=c[1],g=Object(r.useState)(""),p=Object(d.a)(g,2),v=p[0],f=p[1],k=Object(r.useState)(""),h=Object(d.a)(k,2),E=h[0],j=h[1],w=Object(s.f)(),O=Object(V.a)(R,{onError:function(e){console.log(e.graphQLErrors[0].message),window.alert(e.graphQLErrors[0].message)}}),y=Object(d.a)(O,2),S=y[0],L=y[1];return Object(r.useEffect)((function(){L.data&&(n(""),u(""),j(""),window.alert("K\xe4ytt\xe4j\xe4 luotu onnistuneesti."),w.push("/"))}),[L.data,w]),o.a.createElement("div",null,o.a.createElement("h2",null,"Luo uusi k\xe4ytt\xe4j\xe4"),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),S({variables:{user:{username:t,password:l,tag:E}}})}},o.a.createElement("div",null,o.a.createElement(m.a,{label:"K\xe4ytt\xe4j\xe4nimi",onChange:function(e){n(e.target.value)},error:0!==t.length&&t.length<2,helperText:0!==t.length&&t.length<2?"Liian lyhyt":"K\xe4ytt\xe4j\xe4nimesi ei n\xe4y muille pelaajille.",required:!0})),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Pelinimi",onChange:function(e){j(e.target.value)},helperText:"Nimi joka n\xe4kyy muille pelaajille.",required:!0})),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Salasana",type:"password",onChange:function(e){u(e.target.value)},error:l.length<8&&""!==l,helperText:l.length<8&&""!==l?"Liian lyhyt":null,required:!0}),o.a.createElement("div",{style:{paddingTop:20,paddingBottom:10}},o.a.createElement("strong",null,"\xc4l\xe4 k\xe4yt\xe4 samaa salasanaa, joka sinulla on muilla nettisivuilla. "),"Olen vain opiskelija, ja t\xe4m\xe4 on ensimm\xe4inen nettiprojektini, joten en voi taata sivuston tietoturvallisuutta.")),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Salasana uudelleen",type:"password",onChange:function(e){f(e.target.value)},error:v!==l,helperText:v!==l?"Salasanat eiv\xe4t vastaa toisiaan.":null,required:!0})),o.a.createElement("div",null,o.a.createElement(b.a,{variant:"contained",color:"primary",type:"submit"},"Luo k\xe4ytt\xe4j\xe4"))))},oe=t(208),ie=function(){var e=Object(r.useState)(null),a=Object(d.a)(e,2),t=a[0],n=a[1],i=Z().user,c=Object(V.a)(H,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message)}}),l=Object(d.a)(c,2),s=l[0],u=l[1];return Object(r.useEffect)((function(){if(u.data){var e=u.data.createGame.id;n("".concat(window.location,"/").concat(e))}}),[u.data]),o.a.createElement("div",null,o.a.createElement(b.a,{onClick:function(){i?s():console.log("Sinun t\xe4ytyy kirjautua ennen kuin pelaat")}},"Peli linkin kautta"),t?o.a.createElement("div",null,"Jaa t\xe4m\xe4 linkki kaverillesi. Sen kautta p\xe4\xe4set pelaamaan.","  ",o.a.createElement(oe.a,{href:t},t)):null)},ce=t(77),le=t.n(ce),se=t(94),ue=t(125),de=t.n(ue),me=t(126),ge=t.n(me),pe=t(127),be=t.n(pe),ve=t(128),fe=t.n(ve),ke=t(129),he=t.n(ke),Ee=t(130),je=t.n(Ee),we=t(131),Oe=t.n(we),ye=t(132),Se=t.n(ye),Le=t(133),Me=t.n(Le),xe=t(134),Ie=t.n(xe),Ne=t(135),Pe=t.n(Ne),qe=t(136),Ce=t.n(qe),De={width:65,height:65,verticalAlign:"middle"},Ue=function(e,a){return"king"===e&&"black"===a?de.a:"queen"===e&&"black"===a?ge.a:"bishop"===e&&"black"===a?fe.a:"rook"===e&&"black"===a?be.a:"knight"===e&&"black"===a?he.a:"pawn"===e&&"black"===a?je.a:"king"===e&&"white"===a?Oe.a:"queen"===e&&"white"===a?Se.a:"bishop"===e&&"white"===a?Ie.a:"rook"===e&&"white"===a?Me.a:"knight"===e&&"white"===a?Pe.a:"pawn"===e&&"white"===a?Ce.a:void 0},Te=function(e){var a=e.style,t=e.id,i=e.side,c=e.type,l=Object(r.useState)(1),s=Object(d.a)(l,2),u=s[0],m=s[1];return o.a.createElement("img",{style:Object(n.a)(Object(n.a)({},a),{},{opacity:u}),className:"piece",draggable:"true",onDragStart:function(e){q=e.target,m(.5),console.log("dragged:",q)},onDragEnd:function(e){m(1)},type:t,side:i,id:t,src:Ue(c,i),alt:"sprite"})},$e=function(e){var a=e.side,t=e.id,r=Object(n.a)({},De);return o.a.createElement(Te,{style:r,id:t,side:a,type:"king"},"K")},Qe=function(e){var a=e.side,t=e.id,r=Object(n.a)({},De);return o.a.createElement(Te,{style:r,id:t,side:a,type:"queen"},"D")},Ge=function(e){var a=e.side,t=e.id,r=Object(n.a)({},De);return o.a.createElement(Te,{style:r,id:t,side:a,type:"rook"},"T")},Ae=function(e){var a=e.side,t=e.id,r=Object(n.a)({},De);return o.a.createElement(Te,{style:r,id:t,side:a,type:"knight"},"R")},Ke=function(e){var a=e.side,t=e.id,r=Object(n.a)({},De);return o.a.createElement(Te,{style:r,id:t,side:a,type:"bishop"},"L")},He=function(e){var a=e.side,t=e.id,r=Object(n.a)({},De);return o.a.createElement(Te,{style:r,id:t,side:a,type:"pawn"},"S")},Je=function(e){var a=e.color,t=e.makeMove,n=e.location,i=e.piece,c=e.dragHelperMap,l=e.id,s=e.highlight,u=Object(r.useMemo)((function(){return"rgb(".concat("white"===a?"29, 240, 201":"25, 145, 123",")")}),[a]),m=Object(r.useState)(u),g=Object(d.a)(m,2),p=g[0],b=g[1];Object(r.useEffect)((function(){b(s?"rgb(".concat("17, 209, 97",")"):u)}),[s,u]);var v,f={height:70,width:70,backgroundColor:p,textAlign:"center",background:"radial-gradient(".concat(p,", ").concat(u,")")},k=function(){var e=Object(se.a)(le.a.mark((function e(a){var r,o,i,l;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),r={type:c.get(Number(q.id)).type,side:c.get(Number(q.id)).side},o={row:Math.floor(Number(q.id)/8),column:Number(q.id)%8},i=n,("square"===a.target.className||"piece"===a.target.className)&&b(u),e.prev=5,e.next=8,t({piece:r,oldLocation:o,newLocation:i});case 8:(l=e.sent).data.makeMove.lastMove.success||console.log(l.data.makeMove.lastMove.message),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(a){return e.apply(this,arguments)}}(),h=function(e){("square"===e.target.className||"piece"===e.target.className)&&b("17, 209, 97")},E=function(e){"square"===e.target.className&&"piece"!==e.relatedTarget.className?(e.target.id,b(u)):"piece"===e.target.className&&"square"!==e.relatedTarget.className&&(e.target.parentNode.id,b(u))};if(i)switch(i.type){case"pawn":v=o.a.createElement(He,{side:i.side,id:8*n.row+n.column});break;case"rook":v=o.a.createElement(Ge,{side:i.side,id:8*n.row+n.column});break;case"knight":v=o.a.createElement(Ae,{side:i.side,id:8*n.row+n.column});break;case"bishop":v=o.a.createElement(Ke,{side:i.side,id:8*n.row+n.column});break;case"queen":v=o.a.createElement(Qe,{side:i.side,id:8*n.row+n.column});break;case"king":v=o.a.createElement($e,{side:i.side,id:8*n.row+n.column});break;default:v=null}return v?o.a.createElement("td",{id:l,style:f,className:"square",onDragLeave:E,onDragOver:function(e){e.preventDefault()},onDrop:k,onDragEnter:h},v):o.a.createElement("td",{id:l,style:f,className:"square",onDragLeave:E,onDragOver:function(e){e.preventDefault()},onDrop:k,onDragEnter:h})},Be=function(e){var a=e.boardAlignment,t=e.board,n=e.makeMove,r=e.handleClick,i=e.chosenPiece,c=new Map;t.forEach((function(e,a){e.forEach((function(e,t){c.set(8*a+t,e)}))}));var l=Array.from(Array(8),(function(e,a){for(var t=new Array(8),n=0;n<8;n++)t[n]=(a+n)%2===0?{piece:null,color:"white"}:{piece:null,color:"black"};return t}));return o.a.createElement("table",{className:"board",onClick:r},o.a.createElement("tbody",null,"white"===a?t.map((function(e,a){return o.a.createElement("tr",{key:a},e.map((function(e,t){var r=!1;return i&&(i.availableMoves.forEach((function(e){e.newLocation.row===a&&e.newLocation.column===t&&(r=!0)})),i.location.row===a&&i.location.column===t&&(r=!0)),o.a.createElement(Je,{key:8*a+t,id:8*a+t,color:l[a][t].color,makeMove:n,location:{row:a,column:t},piece:e,dragHelperMap:c,highlight:r})})))})):t.map((function(e,a){return o.a.createElement("tr",{key:a},e.map((function(e,r){var s=!1;return i&&(i.availableMoves.forEach((function(e){e.newLocation.row===7-a&&e.newLocation.column===7-r&&(s=!0)})),i.location.row===7-a&&i.location.column===7-r&&(s=!0)),o.a.createElement(Je,{key:8*(7-a)+(7-r),id:8*(7-a)+(7-r),color:l[7-a][7-r].color,makeMove:n,location:{row:7-a,column:7-r},piece:t[7-a][7-r],dragHelperMap:c,highlight:s})})))}))))},Re=function(e){var a=e.game,t=a.check,n=a.currentPlayer,r=a.gameOver,i=a.promotionPlayerID,c=a.winner,l=e.promote,s=Z(),u=s.user;return s.userLoading?"loading...":o.a.createElement("div",{className:"gameText"},u.id!==n||r?o.a.createElement("div",null,"Odotetaan vastustajan siirtoa. ",t&&t.threatenedPlayer!==u.id?"Shakki!":null):o.a.createElement("h3",null,"On sinun vuorosi. ",t&&t.threatenedPlayer===u.id?"Shakki!":null),o.a.createElement("div",null,u.id===i?o.a.createElement("div",null,"Valitse nappula, joksi haluat muuttaa sotilaan"," ",o.a.createElement(b.a,{onClick:function(){return l("queen")}},"Kuningatar"),o.a.createElement(b.a,{onClick:function(){return l("knight")}},"Ratsu")):null),o.a.createElement("h3",null,r?c===u.id?"Voitit pelin! Onneksi olkoon!":"Ootko paska ku h\xe4visit :D":null))},Ve=function(e){var a=e.squareNode,t=e.pieceToMove,n=e.clickedPiece,r=e.game,o=e.user;return a.style.background!=="radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("25, 145, 123","))")&&a.style.background!=="radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("29, 240, 201","))")||n&&n.id===t.id||r.gameOver||r.promotionPlayerID||o.id!==r.currentPlayer},ze=function(e){var a=e.clickedPiece,t=e.game,n=e.user;return n.id===t.currentPlayer&&a.side===(t.whitePlayer===n.id?"white":"black")&&!t.promotionPlayerID&&!t.gameOver},Fe=function(){var e=function(){var e=Object(z.a)(),a=Object(s.g)().id,t=function(t){var n=e.readQuery({query:$,variables:{gameId:a}});n={getGame:t.gameStateUpdated},console.log("newGameData:",t),console.log("gameState tobe:",n),e.writeQuery({query:$,data:n,variables:{id:a}}),console.log("Game state updated with:",e.readQuery({query:$,variables:{id:a}}))},n=Object(F.a)($,{variables:{gameId:a},onError:function(e){Y(e)}}),o=Object(V.a)(K),i=Object(d.a)(o,1)[0],c=Object(V.a)(A),l=Object(d.a)(c,1)[0],u=Object(V.a)(G,{variables:{gameId:a},onError:function(e){Y(e)},onCompleted:function(e){t(e)}}),m=Object(d.a)(u,1)[0];Object(W.a)(Q,{onSubscriptionData:function(e){var a=e.subscriptionData;t(a.data)},variables:{gameId:a}}),Object(r.useEffect)((function(){m()}),[m]);return{game:n.loading||n.error?null:n.data.getGame,gameLoading:n.loading,gameError:n.error,promote:function(e){l({variables:{gameId:a,pieceType:e}})},makeMove:function(e){var t=e.piece,n=e.oldLocation,r=e.newLocation;return i({variables:{move:{piece:t,oldLocation:n,newLocation:r,gameId:a}}})}}}(),a=e.game,t=e.gameLoading,n=e.gameError,i=e.makeMove,c=e.promote,l=Z(),u=l.user,m=l.userLoading,g=Object(r.useState)(null),p=Object(d.a)(g,2),b=p[0],v=p[1];if(t||m)return"loading...";if(!a)return n.toString();var f=a.board,k=a.whitePlayer,h=function(){var e=Object(se.a)(le.a.mark((function e(t){var n,r,o,c,l,s,d,m,g,p,k,h;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),"piece"!==(n=t.target).className){e.next=27;break}if(r=f[Math.floor(Number(n.id)/8)][Number(n.id)%8],!b){e.next=24;break}if(!Ve({squareNode:n.parentNode,pieceToMove:b,clickedPiece:r,user:u,game:a})){e.next=8;break}return v(null),e.abrupt("return");case 8:return o={type:b.type,side:b.side},c={row:b.location.row,column:b.location.column},l={row:r.location.row,column:r.location.column},e.prev=11,e.next=14,i({piece:o,oldLocation:c,newLocation:l});case 14:(s=e.sent).data.makeMove.lastMove.success||console.log(s.data.makeMove.lastMove.message),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),Y(e.t0);case 21:v(null),e.next=25;break;case 24:ze({clickedPiece:r,game:a,user:u})&&(console.log("clickedPiece:",r),v(r));case 25:e.next=54;break;case 27:if("square"!==n.className){e.next=53;break}if((d=n.firstChild)&&(m=f[Math.floor(Number(d.id)/8)][Number(d.id)%8]),!b){e.next=50;break}if(!Ve({squareNode:n,pieceToMove:b,clickedPiece:m,user:u,game:a})){e.next=34;break}return v(null),e.abrupt("return");case 34:return g={type:b.type,side:b.side},p={row:b.location.row,column:b.location.column},k={row:Math.floor(Number(n.id)/8),column:Number(n.id)%8},e.prev=37,e.next=40,i({piece:g,oldLocation:p,newLocation:k});case 40:(h=e.sent).data.makeMove.lastMove.success||console.log(h.data.makeMove.lastMove.message),e.next=47;break;case 44:e.prev=44,e.t1=e.catch(37),Y(e.t1);case 47:v(null),e.next=51;break;case 50:m&&ze({clickedPiece:m,game:a,user:u})&&v(m);case 51:e.next=54;break;case 53:v(null);case 54:case"end":return e.stop()}}),e,null,[[11,18],[37,44]])})));return function(a){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"game"},o.a.createElement("div",null,"Suosittelen nappuloiden liikuttamista klikkaamalla vet\xe4misen sijaan."),o.a.createElement(Be,{board:f,boardAlignment:u.id===k?"white":"black",makeMove:i,handleClick:h,chosenPiece:b}),o.a.createElement(Re,{game:a,promote:c}))},We=function(){var e=Z().user;return o.a.createElement("div",null,o.a.createElement(ne,null),e?o.a.createElement(s.c,null,o.a.createElement(s.a,{path:"/play/:id"},o.a.createElement(Fe,null)),o.a.createElement(s.a,{path:"/play"},o.a.createElement(ie,null)),o.a.createElement(s.a,{path:"/login"},o.a.createElement(_,null)),o.a.createElement(s.a,{path:"/register"},o.a.createElement(re,null))):"Ladataan...",o.a.createElement(u,null))},Xe=t(209),Ye=t(66),Ze=t(84),_e=t(85),ea=t(86),aa=t(116),ta=t(138),na=t(137),ra=t(139),oa=Object(ta.a)((function(e,a){var t=a.headers,r=sessionStorage.getItem("loggedChessUser");return{headers:Object(n.a)(Object(n.a)({},t),{},{authorization:r?"bearer ".concat(r):null})}})),ia=window.location;C="https:"===ia.protocol?"wss:":"ws:",C+="//"+ia.host,console.log("".concat(C,"/graphql"));var ca=new Ye.a({uri:"/graphql"}),la=new ra.a({uri:"".concat(C,"/graphql"),options:{reconnect:!0}}),sa=Object(Ze.a)((function(e){var a=e.query,t=Object(na.a)(a);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),la,oa.concat(ca)),ua=new _e.a({cache:new ea.a,link:sa,connectToDevTools:!0});c.a.render(o.a.createElement(aa.a,{client:ua},o.a.createElement(Xe.a,null,o.a.createElement(l.a,null,o.a.createElement(We,null)))),document.getElementById("root"))}},[[152,1,2]]]);
//# sourceMappingURL=main.fdee2a7b.chunk.js.map