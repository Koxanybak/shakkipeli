(this["webpackJsonpshakki-frontend"]=this["webpackJsonpshakki-frontend"]||[]).push([[0],{143:function(e,t,n){e.exports=n.p+"static/media/blackking.66e1bcad.svg"},144:function(e,t,n){e.exports=n.p+"static/media/blackqueen.7b3e33e4.svg"},145:function(e,t,n){e.exports=n.p+"static/media/blackrook.96872a66.svg"},146:function(e,t,n){e.exports=n.p+"static/media/blackbishop.1f3b8d1a.svg"},147:function(e,t,n){e.exports=n.p+"static/media/blackknight.d39f1d02.svg"},148:function(e,t,n){e.exports=n.p+"static/media/blackpawn.1c52d8c4.svg"},149:function(e,t,n){e.exports=n.p+"static/media/whiteking.250510ff.svg"},150:function(e,t,n){e.exports=n.p+"static/media/whitequeen.4320a2dd.svg"},151:function(e,t,n){e.exports=n.p+"static/media/whiterook.095b1a06.svg"},152:function(e,t,n){e.exports=n.p+"static/media/whitebishop.09004fd2.svg"},153:function(e,t,n){e.exports=n.p+"static/media/whiteknight.e6294efe.svg"},154:function(e,t,n){e.exports=n.p+"static/media/whitepawn.d69014fb.svg"},174:function(e,t,n){e.exports=n(195)},195:function(e,t,n){"use strict";n.r(t);var a=n(23),r=n(0),i=n.n(r),o=n(18),c=n.n(o),l=n(53),s=n(11),u=n(252),m=n(256),d=n(68),v=n(158),g=function(){return i.a.createElement("div",{className:"footer"},i.a.createElement(v.a,null,"Student project for Full Stack open 2020. By using this site you accept the use of essential cookies."))},p=n(258),b=n(232),f=n(260),k=n(234),E=n(19),j=n(14);function y(){var e=Object(E.a)(["\n  mutation resolveGameInvite($from: String, $accepted: Boolean) {\n    resolveGameInvite(\n      from: $from,\n      accepted: $accepted\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function h(){var e=Object(E.a)(["\n  mutation sendGameInvite($tag: String) {\n    sendGameInvite(\n      tag: $tag\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function O(){var e=Object(E.a)(["\n  subscription inviteResolved($tag: String) {\n    inviteResolved(\n      tag: $tag\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return O=function(){return e},e}function w(){var e=Object(E.a)(["\n  subscription inviteReceived($tag: String) {\n    inviteReceived(\n      tag: $tag\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return w=function(){return e},e}function I(){var e=Object(E.a)(["\n  mutation removeFriend($tag: String) {\n    removeFriend(\n      tag: $tag\n    )\n  }\n"]);return I=function(){return e},e}function q(){var e=Object(E.a)(["\n  mutation declineFriendRequest($requestId: String) {\n    declineFriendRequest(\n      requestId: $requestId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return q=function(){return e},e}function S(){var e=Object(E.a)(["\n  mutation acceptFriendRequest($requestId: String) {\n    acceptFriendRequest(\n      requestId: $requestId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return S=function(){return e},e}function C(){var e=Object(E.a)(["\n  mutation sendFriendRequest($tag: String) {\n    sendFriendRequest(\n      tag: $tag\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return C=function(){return e},e}function x(){var e=Object(E.a)(["\n  subscription requestAccepted($userId: String) {\n    requestAccepted(\n      userId: $userId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return x=function(){return e},e}function L(){var e=Object(E.a)(["\n  subscription requestReceived($userId: String) {\n    requestReceived(\n      userId: $userId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return L=function(){return e},e}function D(){var e=Object(E.a)(["\n  query getUserById($userId: String) {\n    getUserById(\n      userId: $userId\n    ) {\n      tag\n    }\n  }\n"]);return D=function(){return e},e}function R(){var e=Object(E.a)(["\n  mutation addUser($user: NewUserInput!) {\n    addUser(\n      user: $user\n    ) {\n      username\n      tag\n      id\n    }\n  }\n"]);return R=function(){return e},e}function P(){var e=Object(E.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(\n      username: $username,\n      password: $password\n    ) {\n      ...userDetails\n    }\n  }\n  ","\n"]);return P=function(){return e},e}function M(){var e=Object(E.a)(["\n  query getLoggedUser($token: String) {\n    getLoggedUser(\n      token: $token\n    ) {\n      ...userDetails\n    }\n  }\n  ","\n"]);return M=function(){return e},e}function $(){var e=Object(E.a)(["\n  fragment userDetails on UserWithToken {\n    username\n    tag\n    friends {\n      tag\n    }\n    sentRequests {\n      ...requestDetails\n    }\n    receivedRequests {\n      ...requestDetails\n    }\n    guest\n    id\n    token\n    sentInvites {\n      ...inviteDetails\n    }\n    receivedInvites {\n      ...inviteDetails\n    }\n  }\n  ","\n  ","\n"]);return $=function(){return e},e}function U(){var e=Object(E.a)(["\n  fragment inviteDetails on GameInvite {\n    from\n    to\n    resolveStatus\n    game {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return U=function(){return e},e}function T(){var e=Object(E.a)(["\n  fragment requestDetails on FriendRequest {\n    from {\n      tag\n    }\n    to {\n      tag\n    }\n    id\n  }\n"]);return T=function(){return e},e}function G(){var e=Object(E.a)(["\n  mutation createGame {\n    createGame {\n      board {\n        type\n        side\n      }\n      id\n    }\n  }\n"]);return G=function(){return e},e}function N(){var e=Object(E.a)(["\n  mutation makeMove($move: MoveInput!) {\n    makeMove(\n      move: $move\n    ) {\n      lastMove {\n        success\n        message\n      }\n    }\n  }\n"]);return N=function(){return e},e}function F(){var e=Object(E.a)(["\n  mutation promote($gameId: String!, $pieceType: String!) {\n    promote(\n      gameId: $gameId,\n      pieceType: $pieceType\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return F=function(){return e},e}function H(){var e=Object(E.a)(["\n  mutation joinGame($gameId: String!) {\n    joinGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return H=function(){return e},e}function Q(){var e=Object(E.a)(["\n  subscription gameStateUpdated($gameId: String!) {\n    gameStateUpdated(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return Q=function(){return e},e}function K(){var e=Object(E.a)(["\n  mutation skipTurn($gameId: String!) {\n    skipTurn(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return K=function(){return e},e}function A(){var e=Object(E.a)(["\n  query getGame($gameId: String!) {\n    getGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return A=function(){return e},e}function B(){var e=Object(E.a)(["\n  fragment gameStateDetails on Game {\n    board {\n      ...idlePiece\n      id\n      availableMoves {\n        newLocation {\n          ...location\n        }\n      }\n    }\n    id\n    currentPlayer\n    whitePlayer\n    blackPlayer\n    winner\n    gameOver\n    promotionPlayerID\n    check {\n      threatenedPlayer\n      movesAvailable {\n        piece {\n          type\n          side\n        }\n        newLocation {\n          ...location\n        }\n      }\n    }\n    moveHistory {\n      ... on CastlingMove {\n        piece {\n          ...movedPiece\n        }\n        castledPiece {\n          ...movedPiece\n        }\n      }\n      ... on PromotionMove {\n        promotedPiece {\n          ...idlePiece\n        }\n        promotedTo\n      }\n      ... on OrdinaryMove {\n        piece {\n          ...movedPiece\n        }\n        pieceEaten {\n          ...idlePiece\n        }\n        newLocation {\n          ...location\n        }\n      }\n      ... on SkipMove {\n        isSkip\n      }\n      ...moveHistoryEntry\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return B=function(){return e},e}function _(){var e=Object(E.a)(["\n fragment moveHistoryEntry on MoveHistoryEntry {\n   leadToCheck\n   wonTheGame\n }\n"]);return _=function(){return e},e}function V(){var e=Object(E.a)(["\n  fragment movedPiece on Piece {\n    type\n    side\n    lastLocation {\n      ...location\n    }\n  }\n  ","\n"]);return V=function(){return e},e}function z(){var e=Object(E.a)(["\n  fragment idlePiece on Piece {\n    type\n    side\n    location {\n      ...location\n    }\n  }\n  ","\n"]);return z=function(){return e},e}function W(){var e=Object(E.a)(["\n  fragment location on Location {\n    row\n    column\n  }\n"]);return W=function(){return e},e}var J=Object(j.a)(W()),Y=Object(j.a)(z(),J),X=Object(j.a)(V(),J),Z=Object(j.a)(_()),ee=Object(j.a)(B(),J,Y,X,Z),te=Object(j.a)(A(),ee),ne=Object(j.a)(K(),ee),ae=Object(j.a)(Q(),ee),re=Object(j.a)(H(),ee),ie=Object(j.a)(F(),ee),oe=Object(j.a)(N()),ce=Object(j.a)(G()),le=Object(j.a)(T()),se=Object(j.a)(U(),ee),ue=Object(j.a)($(),se,le),me=Object(j.a)(M(),ue),de=Object(j.a)(P(),ue),ve=Object(j.a)(R()),ge=Object(j.a)(D()),pe=Object(j.a)(L(),le),be=Object(j.a)(x(),le),fe=Object(j.a)(C(),le),ke=Object(j.a)(S(),le),Ee=Object(j.a)(q(),le),je=Object(j.a)(I()),ye=Object(j.a)(w(),se),he=Object(j.a)(O(),se),Oe=Object(j.a)(h(),se),we=Object(j.a)(y(),se),Ie=n(135),qe=n(40),Se=n.n(qe),Ce=n(62),xe=n(132),Le=n(134),De=n(136),Re=function(e){e.graphQLErrors&&e.graphQLErrors[0]?(console.log(e.graphQLErrors[0].message),e.graphQLErrors[0].stack&&console.log(e.graphQLErrors[0].stack)):(console.log(e.message),e.stack&&console.log(e.stack))},Pe=function(){var e=Object(xe.a)(),t=Object(r.useState)(null),n=Object(s.a)(t,2),a=n[0],i=n[1],o=Object(Le.a)(me,{variables:{token:window.localStorage.getItem("loggedChessUser")?window.localStorage.getItem("loggedChessUser"):window.sessionStorage.getItem("loggedChessUser")},onError:function(e){Re(e)}}),c=o.loading,l=o.data,u=o.error,m=Object(r.useCallback)(Object(Ce.a)(Se.a.mark((function t(){return Se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("logged out"),window.localStorage.removeItem("loggedChessUser"),window.sessionStorage.removeItem("loggedChessUser"),i(null),t.next=6,e.cache.reset();case 6:return t.abrupt("return");case 7:case"end":return t.stop()}}),t)}))),[e.cache]),d=Object(r.useCallback)((function(t,n){var a={getLoggedUser:t};n&&window.localStorage.setItem("loggedChessUser",t.token),window.sessionStorage.setItem("loggedChessUser",t.token),e.writeQuery({query:me,data:a,variables:{token:t.token}}),i(t.token)}),[e]);Object(r.useEffect)((function(){l&&(d(l.getLoggedUser),i(l.getLoggedUser.token))}),[l,d]);var v=null;return c||u||!a||(v=e.readQuery({query:me,variables:{token:a}})),{user:c||u||!a?null:v.getLoggedUser,userLoading:c,userError:u,setUser:d,removeUser:m}},Me=function(e){var t=Object(xe.a)(),n=Object(d.f)(),r=function(n,r){var i={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{sentRequests:e.sentRequests.filter((function(e){return e.id!==n.id})),receivedRequests:e.receivedRequests.filter((function(e){return e.id!==n.id})),friends:e.friends.find((function(e){return e.tag===n.to.tag}))?e.friends:e.friends.concat(r?{tag:n.from.tag}:{tag:n.to.tag})})};t.writeQuery({query:me,data:i,variables:{token:e.token}})},i=function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{receivedInvites:n})};t.writeQuery({query:me,data:r,variables:{token:e.token}})},o=function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{sentInvites:n})};t.writeQuery({query:me,data:r,variables:{token:e.token}})};Object(De.a)(pe,{variables:{userId:e?e.id:null},onError:function(e){console.log("virhe"),Re(e)},onSubscriptionComplete:function(){console.log("Listening to incoming friend requests")},onSubscriptionData:function(n){var r=n.subscriptionData;console.log("Data from req reception:",r),function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{receivedRequests:e.receivedRequests.find((function(e){return e.id===n.id}))?e.receivedRequests:e.receivedRequests.concat(n)})};t.writeQuery({query:me,data:r,variables:{token:e.token}})}(r.data.requestReceived)}}),Object(De.a)(be,{variables:{userId:e?e.id:null},onError:function(e){console.log("virhe"),Re(e)},onSubscriptionComplete:function(){console.log("Listening to accepts to the reqs...")},onSubscriptionData:function(e){var t=e.subscriptionData;console.log("Data from req acception:",t),r(t.data.requestAccepted)}});var c=Object(Ie.a)(fe,{onCompleted:function(n){!function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{sentRequests:e.sentRequests.find((function(e){return e.id===n.id}))?e.sentRequests:e.sentRequests.concat(n)})};t.writeQuery({query:me,data:r,variables:{token:e.token}})}(n.sendFriendRequest)}}),l=Object(s.a)(c,2),u=l[0],m=l[1].data,v=Object(Ie.a)(ke,{onError:function(e){Re(e)},onCompleted:function(e){r(e.acceptFriendRequest,!0)}}),g=Object(s.a)(v,2),p=g[0],b=g[1].data,f=Object(Ie.a)(Ee,{onError:function(e){Re(e)},onCompleted:function(n){!function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{receivedRequests:e.receivedRequests.filter((function(e){return e.id!==n.id}))})};t.writeQuery({query:me,data:r,variables:{token:e.token}})}(n.declineFriendRequest)}}),k=Object(s.a)(f,2),E=k[0],j=k[1].data,y=Object(Ie.a)(je,{onError:function(e){Re(e)}}),h=Object(s.a)(y,1)[0];Object(De.a)(ye,{variables:{tag:e?e.tag:null},onError:function(e){console.log("virhe"),Re(e)},onSubscriptionData:function(t){var n=t.subscriptionData;if(console.log("Data from inv reception:",n),!e.receivedInvites)return i([n.data.inviteReceived]),void console.log("were set to",[n.data.inviteReceived]);e.receivedInvites.find((function(e){return e.from===n.data.inviteReceived.from}))||i(e.receivedInvites.concat(n.data.inviteReceived))}}),Object(De.a)(he,{variables:{tag:e?e.tag:null},onError:function(e){console.log("virhe"),Re(e)},onSubscriptionData:function(t){var a=t.subscriptionData;console.log("Data from inv resolving:",a),e.sentInvites?o(e.sentInvites.filter((function(e){return e.to!==a.data.inviteResolved.to}))):o([]),"accepted"===a.data.inviteResolved.resolveStatus&&(n.push("/"),n.push("play/".concat(a.data.inviteResolved.game.id)))}});var O=Object(Ie.a)(Oe,{onCompleted:function(t){console.log("sent inv",t.sendGameInvite),e.receivedInvites&&e.receivedInvites.find((function(e){return e.from===t.sendGameInvite.to}))||(e.sentInvites?null!==t.sendGameInvite.resolveStatus||e.sentInvites.find((function(e){return e.to===t.sendGameInvite.to}))||o(e.sentInvites.concat(t.sendGameInvite)):o([t.sendGameInvite]))}}),w=Object(s.a)(O,1)[0],I=Object(Ie.a)(we,{onError:function(e){Re(e)},onCompleted:function(t){console.log("resolved inv",t.resolveGameInvite),e.receivedInvites?i(e.receivedInvites.filter((function(e){return e.from!==t.resolveGameInvite.from}))):i([]),"accepted"===t.resolveGameInvite.resolveStatus&&(n.push("/"),n.push("play/".concat(t.resolveGameInvite.game.id)))}});return{acceptReq:p,acceptReqData:b,sendReq:u,sendReqData:m,removeFriend:h,declineReq:E,declineReqData:j,sendGameInv:w,resolveGameInv:Object(s.a)(I,1)[0]}},$e=(i.a.createContext(null),i.a.createContext(null),i.a.createContext(null)),Ue=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),c=Object(s.a)(o,2),l=c[0],u=c[1],m=Object(r.useState)(!0),g=Object(s.a)(m,2),E=g[0],j=g[1],y=Object(r.useContext)($e).setFeedback,h=Pe().setUser,O=Object(d.f)(),w=Object(Ie.a)(de,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message),y({message:e.message,severity:"error"}),u("")}}),I=Object(s.a)(w,2),q=I[0],S=I[1];return Object(r.useEffect)((function(){S.data&&(a(""),u(""),h(S.data.login,E),O.push("/"),window.location.reload(!0))}),[S.data,h,O,E]),i.a.createElement("div",null,i.a.createElement(v.a,{style:{padding:10}},i.a.createElement("h2",null,"Kirjaudu sis\xe4\xe4n"),i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),q({variables:{username:n,password:l}})}},i.a.createElement("div",null,i.a.createElement(p.a,{id:"username",label:"K\xe4ytt\xe4j\xe4nimi",value:n,onChange:function(e){a(e.target.value)},name:"username"})),i.a.createElement("div",null,i.a.createElement(p.a,{id:"password",label:"Salasana",type:"password",value:l,onChange:function(e){u(e.target.value)},name:"password"})),i.a.createElement("div",null,i.a.createElement(b.a,{control:i.a.createElement(f.a,{checked:E,onChange:function(){return j(!E)},name:"rememberMe",color:"primary"}),label:"Muista minut"})),i.a.createElement("div",null,i.a.createElement(k.a,{variant:"contained",color:"primary",type:"submit",id:"login-button"},"Kirjaudu"))),i.a.createElement("div",null,"tai"),i.a.createElement("div",null,i.a.createElement(k.a,{variant:"contained",color:"primary",onClick:function(){return O.push("/register")}},"Luo uusi k\xe4ytt\xe4j\xe4"))))},Te=n(250),Ge=n(251),Ne=n(69),Fe=n(233),He=n(253),Qe=n(261),Ke=n(231),Ae=n(240),Be=n(241),_e=n(242),Ve=n(246),ze=n(247),We=n(243),Je=n(244),Ye=n(245),Xe=n(248),Ze=n(249),et=n(235),tt=n(236),nt=n(237),at=n(238),rt=n(239),it=n(262),ot=n(259),ct=function(){var e=Object(r.useContext)($e),t=e.feedback,n=e.setFeedback;return i.a.createElement(it.a,{open:!!t,autoHideDuration:6e3,onClose:function(){return n(null)}},i.a.createElement(ot.a,{onClose:function(){return n(null)},severity:t?t.severity:"info"},t?t.message:""))},lt=i.a.forwardRef((function(e,t){var n=e.sendReq,a=Object(r.useState)(!1),o=Object(s.a)(a,2),c=o[0],l=o[1],u=Object(r.useState)(""),m=Object(s.a)(u,2),d=m[0],v=m[1],g=Object(r.useContext)($e).setFeedback;i.a.useImperativeHandle(t,(function(){return{setOpen:l}}));var b=function(){var e=Object(Ce.a)(Se.a.mark((function e(){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({variables:{tag:d}});case 3:g({message:"Kaveripyynt\xf6 l\xe4hetetty",severity:"success"}),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("l\xf6ytys vrihe"),g({message:e.t0.message,severity:"error"});case 10:v("");case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return i.a.createElement("div",null,i.a.createElement(et.a,{open:c,onClose:function(){return l(!1)}},i.a.createElement(tt.a,null,"Lis\xe4\xe4 kaveri"),i.a.createElement(nt.a,null,i.a.createElement(at.a,null,"Kirjoita t\xe4h\xe4n kaverisi pelinimi."),i.a.createElement(p.a,{id:"add-friend-tag",value:d,label:"Pelinimi",onChange:function(e){return v(e.target.value)}})),i.a.createElement(rt.a,null,i.a.createElement(k.a,{onClick:function(){return l(!1)},id:"friend-request-cancel"},"Peruuta"),i.a.createElement(k.a,{onClick:function(){return b()},id:"friend-request-send"},"Lis\xe4\xe4")),i.a.createElement(nt.a,null,i.a.createElement(ct,null))))}));lt.displayName="AddFriendDialog";var st=lt,ut=i.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(s.a)(n,2),o=a[0],c=a[1],l=Pe(),u=l.user,m=l.removeUser,d=Me(u),v=d.acceptReq,g=d.declineReq,p=d.sendGameInv,b=d.resolveGameInv,f=d.sendReq,k=i.a.createRef(),E=function(){c(!0)};Object(r.useImperativeHandle)(t,(function(){return{openDrawer:E}}));var j=function(){var e=Object(Ce.a)(Se.a.mark((function e(t){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.receivedInvites&&u.receivedInvites.find((function(e){return e.from===t}))){e.next=3;break}return e.next=3,p({variables:{tag:t}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(Ce.a)(Se.a.mark((function e(t,n){return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b({variables:{from:t,accepted:n}});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}();return u&&u.guest?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(Qe.a,{open:o,onClose:function(){return c(!1)},onOpen:function(){return c(!0)},anchor:"right"},i.a.createElement("div",{style:{width:"32vh"}},i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,null,i.a.createElement(Be.a,{primary:u?"Kirjautuneena ".concat(u.tag):null})),i.a.createElement(_e.a,null),u&&0!==u.receivedRequests.length?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ae.a,null,i.a.createElement(Be.a,{primary:"Kaveripyynn\xf6t"})),u.receivedRequests.map((function(e){return i.a.createElement(Ae.a,{key:e.id},i.a.createElement(Be.a,{secondary:"K\xe4ytt\xe4j\xe4lt\xe4 ".concat(e.from.tag)}),i.a.createElement(Fe.a,{onClick:function(){return v({variables:{requestId:e.id}})}},i.a.createElement(We.a,null)),i.a.createElement(Fe.a,{onClick:function(){return g({variables:{requestId:e.id}})}},i.a.createElement(Je.a,null)))})),i.a.createElement(_e.a,null)):null,i.a.createElement(Ae.a,null,i.a.createElement(Be.a,{primary:"Kaverit"})),u&&0!==u.friends.length?u.friends.map((function(e){return i.a.createElement(Ae.a,{key:e.tag},i.a.createElement(Be.a,{secondary:e.tag}),i.a.createElement(Fe.a,{onClick:function(){return j(e.tag)}},i.a.createElement(Ye.a,null)))})):i.a.createElement(Ae.a,null,i.a.createElement(Be.a,{secondary:"Sinulla ei ole viel\xe4 kavereita."})),i.a.createElement(_e.a,null),i.a.createElement(Ae.a,null,i.a.createElement(Be.a,{primary:"L\xe4hetetyt pelikutsut"})),u&&u.sentInvites?u.sentInvites.map((function(e){return i.a.createElement(Ae.a,{key:e.to},i.a.createElement(Be.a,{secondary:"k\xe4ytt\xe4j\xe4lle ".concat(e.to)}))})):null,i.a.createElement(_e.a,null),i.a.createElement(Ae.a,null,i.a.createElement(Be.a,{primary:"Vastaanotetut pelikutsut"})),u&&u.receivedInvites?u.receivedInvites.map((function(e){return i.a.createElement(Ae.a,{key:e.from},i.a.createElement(Be.a,{secondary:"k\xe4ytt\xe4j\xe4lt\xe4 ".concat(e.from)}),i.a.createElement(Fe.a,{onClick:function(){return y(e.from,!0)}},i.a.createElement(We.a,null)),i.a.createElement(Fe.a,{onClick:function(){return y(e.from,!1)}},i.a.createElement(Je.a,null)))})):null,i.a.createElement(_e.a,null),i.a.createElement(Ae.a,{button:!0,onClick:function(){m(),console.log("has been removed"),c(!1),window.location.reload()},component:Ve.a,to:"/"},i.a.createElement(ze.a,null,i.a.createElement(Xe.a,null)),i.a.createElement(Be.a,{primary:"Kirjaudu ulos"})),i.a.createElement(Ae.a,{button:!0,onClick:function(){return k.current.setOpen(!0)}},i.a.createElement(ze.a,null,i.a.createElement(Ze.a,null)),i.a.createElement(Be.a,{primary:"Lis\xe4\xe4 kaveri"})),i.a.createElement(Ae.a,null,i.a.createElement(Be.a,{secondary:"Huom. kaverilistassa ei n\xe4y, onko kaveri paikalla shakkipeliss\xe4,\r ja pelikutsu ei saavu perille h\xe4nen ollessa poissa.\r Kaveripyynn\xf6n l\xe4hett\xe4minen onnistuu kyll\xe4, vaikka h\xe4n ei olisi paikalla."}))))),i.a.createElement(st,{sendReq:f,ref:k}))}));ut.displayName="ProfileDrawer";var mt,dt=ut,vt=n(254),gt=function(){var e=Pe().user,t=i.a.createRef();return i.a.createElement(Te.a,{position:"static"},i.a.createElement(Ge.a,null,i.a.createElement(u.a,{container:!0,alignItems:"center",justify:"space-between"},i.a.createElement(u.a,{item:!0},i.a.createElement(k.a,{color:"inherit",component:l.b,to:"/play"},"Pelaa"),i.a.createElement(k.a,{color:"inherit",component:l.b,to:"/info"},"Ohjeet")),i.a.createElement(u.a,{item:!0},i.a.createElement(Ne.a,{variant:"subtitle2"},"Ongelmatilanteessa sivun uudelleenlaataaminen yleens\xe4 auttaa.")),i.a.createElement(u.a,{item:!0},!e||e.guest?i.a.createElement(k.a,{color:"inherit",component:l.b,to:"/login"},"Kirjaudu"):i.a.createElement(i.a.Fragment,null,i.a.createElement(Fe.a,{onClick:function(){return t.current.openDrawer()},id:"profile-button"},i.a.createElement(He.a,{badgeContent:e?(e.receivedRequests?e.receivedRequests.length:0)+(e.receivedInvites?e.receivedInvites.length:0):0,color:"primary"},i.a.createElement(vt.a,{style:{color:"white"}})))))),i.a.createElement(dt,{ref:t})))},pt=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),c=Object(s.a)(o,2),l=c[0],u=c[1],m=Object(r.useState)(""),g=Object(s.a)(m,2),b=g[0],f=g[1],E=Object(r.useState)(""),j=Object(s.a)(E,2),y=j[0],h=j[1],O=Object(r.useContext)($e).setFeedback,w=Object(d.f)(),I=Object(Ie.a)(ve,{onError:function(e){console.log(e.graphQLErrors[0].message),O({message:e.message,severity:"error"})}}),q=Object(s.a)(I,2),S=q[0],C=q[1];Object(r.useEffect)((function(){C.data&&(a(""),u(""),h(""),O({message:"K\xe4ytt\xe4j\xe4 luotu onnistuneesti.",severity:"success"}),w.push("/"))}),[C.data,w,O]);var x={background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:"20px"};return i.a.createElement(v.a,{style:x},i.a.createElement("h2",null,"Luo uusi k\xe4ytt\xe4j\xe4"),i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),S({variables:{user:{username:n,password:l,tag:y}}})}},i.a.createElement("div",null,i.a.createElement(p.a,{label:"K\xe4ytt\xe4j\xe4nimi",onChange:function(e){a(e.target.value)},error:0!==n.length&&n.length<2,helperText:0!==n.length&&n.length<2?"Liian lyhyt":"K\xe4ytt\xe4j\xe4nimesi ei n\xe4y muille pelaajille.",required:!0})),i.a.createElement("div",null,i.a.createElement(p.a,{label:"Pelinimi",onChange:function(e){h(e.target.value)},helperText:"Nimi joka n\xe4kyy muille pelaajille.",required:!0})),i.a.createElement("div",null,i.a.createElement(p.a,{label:"Salasana",type:"password",onChange:function(e){u(e.target.value)},error:l.length<8&&""!==l,helperText:l.length<8&&""!==l?"Liian lyhyt":null,required:!0}),i.a.createElement("div",{style:{paddingTop:20,paddingBottom:10}},i.a.createElement("strong",null,"\xc4l\xe4 k\xe4yt\xe4 samaa salasanaa, joka sinulla on muilla nettisivuilla. "),"Olen vain opiskelija, ja t\xe4m\xe4 on ensimm\xe4inen nettiprojektini, joten en voi taata sivuston tietoturvallisuutta.")),i.a.createElement("div",null,i.a.createElement(p.a,{label:"Salasana uudelleen",type:"password",onChange:function(e){f(e.target.value)},error:b!==l,helperText:b!==l?"Salasanat eiv\xe4t vastaa toisiaan.":null,required:!0})),i.a.createElement("div",null,i.a.createElement(k.a,{variant:"contained",color:"primary",type:"submit"},"Luo k\xe4ytt\xe4j\xe4"))))},bt=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Pe().user,c=Object(Ie.a)(ce,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message)}}),l=Object(s.a)(c,2),u=l[0],m=l[1];return Object(r.useEffect)((function(){if(m.data){var e=m.data.createGame.id;a("".concat(window.location,"/").concat(e))}}),[m.data]),i.a.createElement("div",null,i.a.createElement(v.a,{style:{background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:10}},n?i.a.createElement(i.a.Fragment,null,i.a.createElement(v.a,{style:{background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:10}},"Jaa t\xe4m\xe4 linkki kaverillesi. Sen kautta p\xe4\xe4set pelaamaan.","  ",i.a.createElement(Ve.a,{href:n},n)),i.a.createElement(Ne.a,{variant:"subtitle2"},"voit my\xf6s kirjautua sis\xe4\xe4n ja kutsua kaverisi peliin profiilivalikosta.")):i.a.createElement(i.a.Fragment,null,i.a.createElement(k.a,{variant:"contained",onClick:function(){o?u():console.log("Sinun t\xe4ytyy kirjautua ennen kuin pelaat")}},"Peli linkin kautta"),i.a.createElement(Ne.a,{variant:"subtitle2"},"tai kirjaudu sis\xe4\xe4n ja kutsu kaverisi peliin profiilivalikosta."))))},ft=n(143),kt=n.n(ft),Et=n(144),jt=n.n(Et),yt=n(145),ht=n.n(yt),Ot=n(146),wt=n.n(Ot),It=n(147),qt=n.n(It),St=n(148),Ct=n.n(St),xt=n(149),Lt=n.n(xt),Dt=n(150),Rt=n.n(Dt),Pt=n(151),Mt=n.n(Pt),$t=n(152),Ut=n.n($t),Tt=n(153),Gt=n.n(Tt),Nt=n(154),Ft=n.n(Nt),Ht={width:65,height:65,verticalAlign:"middle"},Qt=function(e,t){return"king"===e&&"black"===t?kt.a:"queen"===e&&"black"===t?jt.a:"bishop"===e&&"black"===t?wt.a:"rook"===e&&"black"===t?ht.a:"knight"===e&&"black"===t?qt.a:"pawn"===e&&"black"===t?Ct.a:"king"===e&&"white"===t?Lt.a:"queen"===e&&"white"===t?Rt.a:"bishop"===e&&"white"===t?Ut.a:"rook"===e&&"white"===t?Mt.a:"knight"===e&&"white"===t?Gt.a:"pawn"===e&&"white"===t?Ft.a:void 0},Kt=function(e){var t=e.style,n=e.id,o=e.side,c=e.type,l=Object(r.useState)(1),u=Object(s.a)(l,1)[0];return i.a.createElement("img",{style:Object(a.a)(Object(a.a)({},t),{},{opacity:u}),className:"piece",draggable:"false",type:n,side:o,id:n,src:Qt(c,o),alt:"sprite"})},At=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ht);return i.a.createElement(Kt,{style:r,id:n,side:t,type:"king"},"K")},Bt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ht);return i.a.createElement(Kt,{style:r,id:n,side:t,type:"queen"},"D")},_t=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ht);return i.a.createElement(Kt,{style:r,id:n,side:t,type:"rook"},"T")},Vt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ht);return i.a.createElement(Kt,{style:r,id:n,side:t,type:"knight"},"R")},zt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ht);return i.a.createElement(Kt,{style:r,id:n,side:t,type:"bishop"},"L")},Wt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ht);return i.a.createElement(Kt,{style:r,id:n,side:t,type:"pawn"},"S")},Jt=function(e){var t=e.color,n=(e.makeMove,e.location),a=e.piece,o=(e.dragHelperMap,e.id),c=e.highlight,l=Object(r.useMemo)((function(){return"rgb(".concat("white"===t?"29, 240, 201":"25, 145, 123",")")}),[t]),u=Object(r.useState)(l),m=Object(s.a)(u,2),d=m[0],v=m[1];Object(r.useEffect)((function(){v(c?"rgb(".concat("17, 209, 97",")"):l)}),[c,l]);var g,p={height:70,width:70,backgroundColor:d,textAlign:"center",background:"radial-gradient(".concat(d,", ").concat(l,")")};if(a)switch(a.type){case"pawn":g=i.a.createElement(Wt,{side:a.side,id:8*n.row+n.column});break;case"rook":g=i.a.createElement(_t,{side:a.side,id:8*n.row+n.column});break;case"knight":g=i.a.createElement(Vt,{side:a.side,id:8*n.row+n.column});break;case"bishop":g=i.a.createElement(zt,{side:a.side,id:8*n.row+n.column});break;case"queen":g=i.a.createElement(Bt,{side:a.side,id:8*n.row+n.column});break;case"king":g=i.a.createElement(At,{side:a.side,id:8*n.row+n.column});break;default:g=null}return g?i.a.createElement("td",{id:o,style:p,className:"square"},g):i.a.createElement("td",{id:o,style:p,className:"square"})},Yt=function(e){var t=e.boardAlignment,n=e.board,a=e.makeMove,r=e.handleClick,o=e.chosenPiece,c=new Map;n.forEach((function(e,t){e.forEach((function(e,n){c.set(8*t+n,e)}))}));var l=Array.from(Array(8),(function(e,t){for(var n=new Array(8),a=0;a<8;a++)n[a]=(t+a)%2===0?{piece:null,color:"white"}:{piece:null,color:"black"};return n})),s={height:560,width:560,borderStyle:"solid",borderColor:"black",borderWidth:"2px",background:"cyan"};return i.a.createElement("table",{className:"board",onClick:r,cellSpacing:"0",style:s},i.a.createElement("tbody",null,"white"===t?n.map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,8-t),e.map((function(e,n){var r=!1;return o&&(o.availableMoves.forEach((function(e){e.newLocation.row===t&&e.newLocation.column===n&&(r=!0)})),o.location.row===t&&o.location.column===n&&(r=!0)),i.a.createElement(Jt,{key:8*t+n,id:8*t+n,color:l[t][n].color,makeMove:a,location:{row:t,column:n},piece:e,dragHelperMap:c,highlight:r})})))})):n.map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,t+1),e.map((function(e,r){var s=!1;return o&&(o.availableMoves.forEach((function(e){e.newLocation.row===7-t&&e.newLocation.column===7-r&&(s=!0)})),o.location.row===7-t&&o.location.column===7-r&&(s=!0)),i.a.createElement(Jt,{key:8*(7-t)+(7-r),id:8*(7-t)+(7-r),color:l[7-t][7-r].color,makeMove:a,location:{row:7-t,column:7-r},piece:n[7-t][7-r],dragHelperMap:c,highlight:s})})))})),"white"===t?i.a.createElement("tr",null,i.a.createElement("td",null),i.a.createElement("td",null,"A"),i.a.createElement("td",null,"B"),i.a.createElement("td",null,"C"),i.a.createElement("td",null,"D"),i.a.createElement("td",null,"E"),i.a.createElement("td",null,"F"),i.a.createElement("td",null,"G"),i.a.createElement("td",null,"H")):i.a.createElement("tr",null,i.a.createElement("td",null),i.a.createElement("td",null,"H"),i.a.createElement("td",null,"G"),i.a.createElement("td",null,"F"),i.a.createElement("td",null,"E"),i.a.createElement("td",null,"D"),i.a.createElement("td",null,"C"),i.a.createElement("td",null,"B"),i.a.createElement("td",null,"A"))))},Xt=n(255),Zt=Object(Xt.a)({turnText:{background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:10,height:"8vh",width:"40vh",textAlign:"center"}}),en=function(e){var t=e.game,n=t.check,a=t.currentPlayer,o=t.gameOver,c=t.promotionPlayerID,l=t.winner,u=t.blackPlayer,m=e.promote,d=Pe(),g=d.user,p=d.userLoading,b=Object(r.useState)("Odotetaan, ett\xe4 vastustaja liityy peliin."),f=Object(s.a)(b,2),E=f[0],j=f[1],y=Object(r.useState)(!1),h=Object(s.a)(y,2),O=h[0],w=h[1],I=Zt();return Object(r.useEffect)((function(){g&&(u?o?(l===g.id?j("Voitit pelin! Onneksi olkoon!"):j("Ootko paska ku h\xe4visit :D"),w(!0)):g.id===a?(n&&n.threatenedPlayer===g.id?j("On sinun vuorosi. Shakki!"):j("On sinun vuorosi."),w(!0)):(n&&n.threatenedPlayer!==g.id?j("Odotetaan vastustajan siirtoa. Shakki!"):j("Odotetaan vastustajan siirtoa."),w(!1)):(w(!1),j("Odotetaan, ett\xe4 vastustaja liityy peliin.")))}),[j,u,o,a,g,l,n]),p?"loading...":i.a.createElement("div",{className:"gameText"},i.a.createElement(v.a,{className:I.turnText},i.a.createElement(Ne.a,{variant:O?"h4":"subtitle1"},E)),i.a.createElement("div",null,g.id===c?i.a.createElement(v.a,{className:I.turnText},"Valitse nappula, joksi haluat muuttaa sotilaan"," ",i.a.createElement(k.a,{onClick:function(){return m("queen")}},"Kuningatar"),i.a.createElement(k.a,{onClick:function(){return m("knight")}},"Ratsu")):null))},tn=function(e){return 0===e.column?"A".concat(8-e.row):1===e.column?"B".concat(8-e.row):2===e.column?"C".concat(8-e.row):3===e.column?"D".concat(8-e.row):4===e.column?"E".concat(8-e.row):5===e.column?"F".concat(8-e.row):6===e.column?"G".concat(8-e.row):7===e.column?"H".concat(8-e.row):"ErrorLocation"},nn=function(e){var t=e.move,n=e.emphasize,a={borderLeftStyle:"solid",borderColor:"blue",borderWidth:"1px",borderLeftWidth:"10px",padding:10,background:"cyan"},r={borderLeftStyle:"solid",borderColor:"blue",borderWidth:"1px",borderLeftWidth:"5px",margin:5,background:"cyan"},o=n?{height:60,width:60}:void 0;return"OrdinaryMove"===t.__typename?i.a.createElement(v.a,{style:n?a:r},i.a.createElement("img",{style:o,className:"piece",draggable:"false",src:Qt(t.piece.type,t.piece.side),alt:t.piece.type}),tn(t.newLocation)):"CastlingMove"===t.__typename?i.a.createElement(v.a,{style:n?a:r},"Tornitus"):"PromotionMove"===t.__typename?i.a.createElement(v.a,{style:n?a:r},tn(t.promotedPiece.location),i.a.createElement("img",{style:o,className:"piece",draggable:"false",src:Qt(t.promotedPiece.type,t.promotedPiece.side),alt:t.promotedPiece.type}),"---\x3e",i.a.createElement("img",{style:o,className:"piece",draggable:"false",src:Qt(t.promotedTo,t.promotedPiece.side),alt:t.promotedPiece.type})):"SkipMove"===t.__typename?i.a.createElement(v.a,{style:n?a:r},"Vuoro ohitettu."):i.a.createElement(v.a,null,"Error")},an=function(e){var t=e.moveHistory;return i.a.createElement("div",{className:"moveHistory",style:{overflowY:"scroll",height:350}},t.map((function(e,n){return e=t[t.length-1-n],0!==n?i.a.createElement(nn,{move:e,key:n}):null})))},rn=function(e){var t=e.moveHistory,n=Object(r.useState)(!1),a=Object(s.a)(n,2),o=a[0],c=a[1],l={background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:"20px"};if(0===t.length)return i.a.createElement(v.a,{style:l},i.a.createElement(Ne.a,{variant:"subtitle2"},"Siirtoja ei ole viel\xe4 tehty"));var u=t[t.length-1];return i.a.createElement(v.a,{style:l},i.a.createElement(Ne.a,{variant:"h5"},"Viimeisin siirto"),i.a.createElement(nn,{move:u,emphasize:!0}),i.a.createElement(k.a,{variant:"contained",onClick:function(){return c(!o)},color:"primary"},"N\xe4yt\xe4 kaikki siirrot"),o?i.a.createElement(an,{moveHistory:t}):null)},on=function(e){var t=e.squareNode,n=e.pieceToMove,a=e.clickedPiece,r=e.game,i=e.user;return!t.style.background.includes("radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("25, 145, 123","))"))&&!t.style.background.includes("radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("29, 240, 201","))"))||a&&a.id===n.id||r.gameOver||r.promotionPlayerID||i.id!==r.currentPlayer},cn=function(e){var t=e.clickedPiece,n=e.game,a=e.user;return a.id===n.currentPlayer&&t.side===(n.whitePlayer===a.id?"white":"black")&&!n.promotionPlayerID&&!n.gameOver&&n.whitePlayer&&n.blackPlayer},ln=function(e){var t=e.skipTurn,n=e.disabled,a=e.opponentId,o=Object(r.useState)(!1),c=Object(s.a)(o,2),l=c[0],u=c[1],d=Object(Le.a)(ge,{variables:{userId:a},onError:function(e){Re(e)}}),g=d.data,p=d.error,b=d.loading,f={background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:"20px",textAlign:"center"};return i.a.createElement(v.a,{style:f},a?!g||p||b?i.a.createElement(m.a,null):i.a.createElement(Ne.a,{style:{marginBottom:20}},"Vastustajana ",i.a.createElement("strong",null,g.getUserById.tag)):i.a.createElement(Ne.a,{style:{marginBottom:20}},"Odotetaan vastustajan liittymist\xe4"),l?i.a.createElement("div",null,i.a.createElement(Ne.a,{variant:"subtitle2"},"Vahvista ohitus?"),i.a.createElement(k.a,{variant:"outlined",size:"small",onClick:function(){t(),u(!1)},disabled:n},"Ohita"),i.a.createElement(k.a,{variant:"outlined",size:"small",onClick:function(){u(!1)}},"Peruuta")):i.a.createElement(k.a,{variant:"outlined",size:"small",onClick:function(){return u(!0)},disabled:n},"Ohita vuoro"))},sn=Object(Xt.a)({game:{}}),un=function(){var e=function(){var e=Object(xe.a)(),t=Object(d.g)().id,n=function(n){var a=e.readQuery({query:te,variables:{gameId:t}});a={getGame:n.gameStateUpdated},e.writeQuery({query:te,data:a,variables:{id:t}})},a=Object(Le.a)(te,{variables:{gameId:t},onError:function(e){Re(e)}}),i=Object(Ie.a)(oe,{onError:function(e){Re(e)}}),o=Object(s.a)(i,1)[0],c=Object(Ie.a)(ie),l=Object(s.a)(c,1)[0],u=Object(Ie.a)(ne,{variables:{gameId:t},onError:function(e){Re(e)}}),m=Object(s.a)(u,1)[0],v=Object(Ie.a)(re,{variables:{gameId:t},onError:function(e){Re(e)},onCompleted:function(e){n(e)}}),g=Object(s.a)(v,1)[0];Object(De.a)(ae,{onSubscriptionData:function(e){var t=e.subscriptionData;n(t.data)},variables:{gameId:t}}),Object(r.useEffect)((function(){g()}),[g]);return{game:a.loading||a.error?null:a.data.getGame,gameLoading:a.loading,gameError:a.error,promote:function(e){l({variables:{gameId:t,pieceType:e}})},makeMove:function(e){var n=e.piece,a=e.oldLocation,r=e.newLocation;return o({variables:{move:{piece:n,oldLocation:a,newLocation:r,gameId:t}}})},skipTurn:m}}(),t=e.game,n=e.gameLoading,a=e.gameError,o=e.makeMove,c=e.promote,l=e.skipTurn,v=Pe(),g=v.user,p=v.userLoading,b=Object(r.useState)(null),f=Object(s.a)(b,2),k=f[0],E=f[1],j=sn();if(n||p)return i.a.createElement(m.a,null);if(!t)return a.toString();var y=t.board,h=t.whitePlayer,O=t.moveHistory,w=t.currentPlayer,I=t.promotionPlayerID,q=t.check,S=t.blackPlayer,C=function(){var e=Object(Ce.a)(Se.a.mark((function e(n){var a,r,i,c,l,s,u,m,d,v,p,b;return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),"piece"!==(a=n.target).className){e.next=27;break}if(r=y[Math.floor(Number(a.id)/8)][Number(a.id)%8],!k){e.next=24;break}if(!on({squareNode:a.parentNode,pieceToMove:k,clickedPiece:r,user:g,game:t})){e.next=8;break}return E(null),e.abrupt("return");case 8:return i={type:k.type,side:k.side},c={row:k.location.row,column:k.location.column},l={row:r.location.row,column:r.location.column},e.prev=11,e.next=14,o({piece:i,oldLocation:c,newLocation:l});case 14:(s=e.sent).data.makeMove.lastMove.success||console.log(s.data.makeMove.lastMove.message),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),Re(e.t0);case 21:E(null),e.next=25;break;case 24:cn({clickedPiece:r,game:t,user:g})&&E(r);case 25:e.next=54;break;case 27:if("square"!==a.className){e.next=53;break}if((u=a.firstChild)&&(m=y[Math.floor(Number(u.id)/8)][Number(u.id)%8]),!k){e.next=50;break}if(!on({squareNode:a,pieceToMove:k,clickedPiece:m,user:g,game:t})){e.next=34;break}return E(null),e.abrupt("return");case 34:return d={type:k.type,side:k.side},v={row:k.location.row,column:k.location.column},p={row:Math.floor(Number(a.id)/8),column:Number(a.id)%8},e.prev=37,e.next=40,o({piece:d,oldLocation:v,newLocation:p});case 40:(b=e.sent).data.makeMove.lastMove.success||console.log(b.data.makeMove.lastMove.message),e.next=47;break;case 44:e.prev=44,e.t1=e.catch(37),Re(e.t1);case 47:E(null),e.next=51;break;case 50:m&&cn({clickedPiece:m,game:t,user:g})&&E(m);case 51:e.next=54;break;case 53:E(null);case 54:case"end":return e.stop()}}),e,null,[[11,18],[37,44]])})));return function(t){return e.apply(this,arguments)}}();return i.a.createElement(u.a,{container:!0,direction:"row",justify:"center",className:j.game,spacing:2,wrap:"wrap"},i.a.createElement(u.a,{item:!0,xs:5,lg:2},i.a.createElement(ln,{skipTurn:l,disabled:g.id!==w||null!==I||null!==q||null===h||null===S,opponentId:g.id===h?S:h})),i.a.createElement(u.a,{container:!0,item:!0,xs:10,lg:6,direction:"column",alignItems:"center"},i.a.createElement(Yt,{board:y,boardAlignment:g.id===h?"white":"black",makeMove:o,handleClick:C,chosenPiece:k}),i.a.createElement(en,{game:t,promote:c})),i.a.createElement(u.a,{item:!0,xs:3,lg:3},i.a.createElement(rn,{moveHistory:O})))},mn=n(257),dn=Object(Xt.a)({turnText:{background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:10}}),vn=function(){var e=dn();return i.a.createElement(v.a,{className:e.turnText},"- Shakkia p\xe4\xe4see pelaamaan klikaamalla \u201dpelaa\u201d -nappia ja sitten klikaamalla \u201dpeli linkin kautta\u201d ja klikaamalla sen antamaa linkki\xe4.",i.a.createElement("br",null)," Linkki (tai sen viem\xe4n osoite) pit\xe4\xe4 jakaa kaverille, ja sitten voitte pelata.",i.a.createElement("br",null),"(HUOM. Shakkia ei voi pelata yksin, tosin linkin voi avata toiselle v\xe4lilehdelle ja siten voi pelata yksin)",i.a.createElement("br",null),i.a.createElement("br",null),"- Toinen tapa p\xe4\xe4st\xe4 peliin on luoda k\xe4ytt\xe4j\xe4 ja kirjautua sis\xe4\xe4n. Sen j\xe4lkeen voit l\xe4hett\xe4\xe4 kaveripyynn\xf6\xf6n toiselle k\xe4ytt\xe4j\xe4lle ja kutsua t\xe4m\xe4n peliin profiilivalikosta.",i.a.createElement("br",null),"(HUOM. Kaverilista ei n\xe4yt\xe4, ovatko kaverit paikalla nettisivulla vai eiv\xe4t, ja pelikutsua ei saavu perille heid\xe4n ollessa poissa. Kaveripyynt\xf6 saapuu perille, vaikka he olisivatkin \u201doffline\u201d)",i.a.createElement("br",null),"(HUOM. Kirjautuessa jos j\xe4t\xe4t \u201dmuista minut\u201d ruksitetuksi, olet kirjautuneena kaikilla v\xe4lilehdill\xe4, etk\xe4 voi pelata silloin voi itse\xe4si vastaan kahdella v\xe4lilehdell\xe4)",i.a.createElement("br",null),i.a.createElement("br",null),"- Shakin pit\xe4isi noudattaa kaikkia shakin s\xe4\xe4nt\xf6j\xe4 lukuunottamatta sit\xe4, ett\xe4 vuoron voi halutessa ohittaa, jos ei ole shakkitilannetta. T\xe4m\xe4 on peliss\xe4 siksi, ett\xe4 normaliisti tilanteessa, jossa pelaaja ei voi liikuttaa mit\xe4\xe4n nappulaa, mutta kuningas ei kuitenkaan ole uhattuna, peli p\xe4\xe4ttyy tasapeliin. Itse en jaksanut toteuttaa algoritmia, joka t\xe4m\xe4n tarkastaisi (tai muuta tasapelin vaativaa toiminnallisuutta), joten tein napin, jotta peli p\xe4\xe4see etenem\xe4\xe4n t\xe4llaisissa tilanteissa.",i.a.createElement("br",null),i.a.createElement("br",null),"- Jos ilmenee ongelmia esim. nappulat eiv\xe4t liiku tai muuta, niin sivun uudelleenlataaminen auttaa yleens\xe4.",i.a.createElement("br",null),"(HUOM. l\xe4hetetyt ja vastaanotetut pelikutsut (ei kaveripyynn\xf6t) katoavat t\xe4ll\xf6in n\xe4kyvist\xe4)",i.a.createElement("br",null),i.a.createElement("br",null),"- Sivu toimii Chromella ja Firefoxilla. Muista selaimista en ole varma.",i.a.createElement("br",null),i.a.createElement("br",null),"- K\xe4nnyk\xe4ll\xe4 sivu my\xf6s toimii, mutta se n\xe4ytt\xe4\xe4 hieman hassulta.")},gn=Object(Xt.a)({root:{height:"100%"}}),pn=function(){var e=Pe().user,t=gn(),n=Object(r.useState)(null),a=Object(s.a)(n,2),o=a[0],c=a[1];return i.a.createElement($e.Provider,{value:{feedback:o,setFeedback:c}},i.a.createElement(mn.a,{classes:t},i.a.createElement(u.a,{container:!0,direction:"column",alignItems:"center",justify:"space-between",classes:t,wrap:"nowrap"},i.a.createElement(gt,null),e?i.a.createElement(d.c,null,i.a.createElement(d.a,{path:"/play/:id"},i.a.createElement(un,null)),i.a.createElement(d.a,{path:"/play"},i.a.createElement(bt,null)),i.a.createElement(d.a,{path:"/login"},i.a.createElement(Ue,null)),i.a.createElement(d.a,{path:"/register"},i.a.createElement(pt,null)),i.a.createElement(d.a,{path:"/info"},i.a.createElement(vn,null))):i.a.createElement(m.a,null),i.a.createElement(ct,null),i.a.createElement(g,null))))},bn=n(77),fn=n(100),kn=n(101),En=n(102),jn=n(133),yn=n(156),hn=n(155),On=n(157),wn=Object(yn.a)((function(e,t){var n=t.headers,r=sessionStorage.getItem("loggedChessUser");return{headers:Object(a.a)(Object(a.a)({},n),{},{authorization:r?"bearer ".concat(r):null})}})),In=window.location;mt="https:"===In.protocol?"wss:":"ws:",mt+="//"+In.host;var qn=new bn.a({uri:"/graphql"}),Sn=new On.a({uri:"".concat(mt,"/graphql"),options:{reconnect:!0,connectionParams:{authToken:sessionStorage.getItem("loggedChessUser")?"bearer ".concat(sessionStorage.getItem("loggedChessUser")):null}}}),Cn=Object(fn.a)((function(e){var t=e.query,n=Object(hn.a)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Sn,wn.concat(qn)),xn=new kn.a({cache:new En.a,link:Cn,connectToDevTools:!0});c.a.render(i.a.createElement(jn.a,{client:xn},i.a.createElement(l.a,null,i.a.createElement(pn,null))),document.getElementById("root"))}},[[174,1,2]]]);
//# sourceMappingURL=main.fd457723.chunk.js.map