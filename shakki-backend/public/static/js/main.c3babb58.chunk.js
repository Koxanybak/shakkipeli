(this["webpackJsonpshakki-frontend"]=this["webpackJsonpshakki-frontend"]||[]).push([[0],{145:function(e,t,n){e.exports=n.p+"static/media/blackking.66e1bcad.svg"},146:function(e,t,n){e.exports=n.p+"static/media/blackqueen.7b3e33e4.svg"},147:function(e,t,n){e.exports=n.p+"static/media/blackrook.96872a66.svg"},148:function(e,t,n){e.exports=n.p+"static/media/blackbishop.1f3b8d1a.svg"},149:function(e,t,n){e.exports=n.p+"static/media/blackknight.d39f1d02.svg"},150:function(e,t,n){e.exports=n.p+"static/media/blackpawn.1c52d8c4.svg"},151:function(e,t,n){e.exports=n.p+"static/media/whiteking.250510ff.svg"},152:function(e,t,n){e.exports=n.p+"static/media/whitequeen.4320a2dd.svg"},153:function(e,t,n){e.exports=n.p+"static/media/whiterook.095b1a06.svg"},154:function(e,t,n){e.exports=n.p+"static/media/whitebishop.09004fd2.svg"},155:function(e,t,n){e.exports=n.p+"static/media/whiteknight.e6294efe.svg"},156:function(e,t,n){e.exports=n.p+"static/media/whitepawn.d69014fb.svg"},175:function(e,t,n){e.exports=n(196)},196:function(e,t,n){"use strict";n.r(t);var a=n(23),r=n(0),i=n.n(r),o=n(18),c=n.n(o),l=n(53),s=n(11),u=n(253),d=n(257),m=n(68),g=n(160),v=function(){return i.a.createElement("div",{className:"footer"},i.a.createElement(g.a,null,"Student project for Full Stack open 2020. By using this site you accept the use of essential cookies."))},b=n(259),p=n(233),f=n(261),E=n(235),k=n(19),j=n(14);function h(){var e=Object(k.a)(["\n  mutation resolveGameInvite($from: String, $accepted: Boolean) {\n    resolveGameInvite(\n      from: $from,\n      accepted: $accepted\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function y(){var e=Object(k.a)(["\n  mutation sendGameInvite($tag: String) {\n    sendGameInvite(\n      tag: $tag\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function O(){var e=Object(k.a)(["\n  subscription inviteResolved($tag: String) {\n    inviteResolved(\n      tag: $tag\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return O=function(){return e},e}function w(){var e=Object(k.a)(["\n  subscription inviteReceived($tag: String) {\n    inviteReceived(\n      tag: $tag\n    ) {\n      ...inviteDetails\n    }\n  }\n  ","\n"]);return w=function(){return e},e}function I(){var e=Object(k.a)(["\n  mutation removeFriend($tag: String) {\n    removeFriend(\n      tag: $tag\n    )\n  }\n"]);return I=function(){return e},e}function q(){var e=Object(k.a)(["\n  mutation declineFriendRequest($requestId: String) {\n    declineFriendRequest(\n      requestId: $requestId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return q=function(){return e},e}function S(){var e=Object(k.a)(["\n  mutation acceptFriendRequest($requestId: String) {\n    acceptFriendRequest(\n      requestId: $requestId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return S=function(){return e},e}function C(){var e=Object(k.a)(["\n  mutation sendFriendRequest($tag: String) {\n    sendFriendRequest(\n      tag: $tag\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return C=function(){return e},e}function x(){var e=Object(k.a)(["\n  subscription requestAccepted($userId: String) {\n    requestAccepted(\n      userId: $userId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return x=function(){return e},e}function L(){var e=Object(k.a)(["\n  subscription requestReceived($userId: String) {\n    requestReceived(\n      userId: $userId\n    ) {\n      ...requestDetails\n    }\n  }\n  ","\n"]);return L=function(){return e},e}function D(){var e=Object(k.a)(["\n  mutation addUser($user: NewUserInput!) {\n    addUser(\n      user: $user\n    ) {\n      username\n      tag\n      id\n    }\n  }\n"]);return D=function(){return e},e}function R(){var e=Object(k.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(\n      username: $username,\n      password: $password\n    ) {\n      ...userDetails\n    }\n  }\n  ","\n"]);return R=function(){return e},e}function P(){var e=Object(k.a)(["\n  query getLoggedUser($token: String) {\n    getLoggedUser(\n      token: $token\n    ) {\n      ...userDetails\n    }\n  }\n  ","\n"]);return P=function(){return e},e}function M(){var e=Object(k.a)(["\n  fragment userDetails on UserWithToken {\n    username\n    tag\n    friends {\n      tag\n    }\n    sentRequests {\n      ...requestDetails\n    }\n    receivedRequests {\n      ...requestDetails\n    }\n    guest\n    id\n    token\n    sentInvites {\n      ...inviteDetails\n    }\n    receivedInvites {\n      ...inviteDetails\n    }\n  }\n  ","\n  ","\n"]);return M=function(){return e},e}function $(){var e=Object(k.a)(["\n  fragment inviteDetails on GameInvite {\n    from\n    to\n    resolveStatus\n    game {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return $=function(){return e},e}function U(){var e=Object(k.a)(["\n  fragment requestDetails on FriendRequest {\n    from {\n      tag\n    }\n    to {\n      tag\n    }\n    id\n  }\n"]);return U=function(){return e},e}function G(){var e=Object(k.a)(["\n  mutation createGame {\n    createGame {\n      board {\n        type\n        side\n      }\n      id\n    }\n  }\n"]);return G=function(){return e},e}function T(){var e=Object(k.a)(["\n  mutation makeMove($move: MoveInput!) {\n    makeMove(\n      move: $move\n    ) {\n      lastMove {\n        success\n        message\n      }\n    }\n  }\n"]);return T=function(){return e},e}function N(){var e=Object(k.a)(["\n  mutation promote($gameId: String!, $pieceType: String!) {\n    promote(\n      gameId: $gameId,\n      pieceType: $pieceType\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return N=function(){return e},e}function F(){var e=Object(k.a)(["\n  mutation joinGame($gameId: String!) {\n    joinGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return F=function(){return e},e}function Q(){var e=Object(k.a)(["\n  subscription gameStateUpdated($gameId: String!) {\n    gameStateUpdated(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return Q=function(){return e},e}function H(){var e=Object(k.a)(["\n  mutation skipTurn($gameId: String!) {\n    skipTurn(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return H=function(){return e},e}function K(){var e=Object(k.a)(["\n  query getGame($gameId: String!) {\n    getGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return K=function(){return e},e}function A(){var e=Object(k.a)(["\n  fragment gameStateDetails on Game {\n    board {\n      ...idlePiece\n      id\n      availableMoves {\n        newLocation {\n          ...location\n        }\n      }\n    }\n    id\n    currentPlayer\n    whitePlayer\n    blackPlayer\n    winner\n    gameOver\n    promotionPlayerID\n    check {\n      threatenedPlayer\n      movesAvailable {\n        piece {\n          type\n          side\n        }\n        newLocation {\n          ...location\n        }\n      }\n    }\n    moveHistory {\n      ... on CastlingMove {\n        piece {\n          ...movedPiece\n        }\n        castledPiece {\n          ...movedPiece\n        }\n      }\n      ... on PromotionMove {\n        promotedPiece {\n          ...idlePiece\n        }\n        promotedTo\n      }\n      ... on OrdinaryMove {\n        piece {\n          ...movedPiece\n        }\n        pieceEaten {\n          ...idlePiece\n        }\n        newLocation {\n          ...location\n        }\n      }\n      ... on SkipMove {\n        isSkip\n      }\n      ...moveHistoryEntry\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return A=function(){return e},e}function _(){var e=Object(k.a)(["\n fragment moveHistoryEntry on MoveHistoryEntry {\n   leadToCheck\n   wonTheGame\n }\n"]);return _=function(){return e},e}function B(){var e=Object(k.a)(["\n  fragment movedPiece on Piece {\n    type\n    side\n    lastLocation {\n      ...location\n    }\n  }\n  ","\n"]);return B=function(){return e},e}function z(){var e=Object(k.a)(["\n  fragment idlePiece on Piece {\n    type\n    side\n    location {\n      ...location\n    }\n  }\n  ","\n"]);return z=function(){return e},e}function V(){var e=Object(k.a)(["\n  fragment location on Location {\n    row\n    column\n  }\n"]);return V=function(){return e},e}var W=Object(j.a)(V()),J=Object(j.a)(z(),W),Y=Object(j.a)(B(),W),X=Object(j.a)(_()),Z=Object(j.a)(A(),W,J,Y,X),ee=Object(j.a)(K(),Z),te=Object(j.a)(H(),Z),ne=Object(j.a)(Q(),Z),ae=Object(j.a)(F(),Z),re=Object(j.a)(N(),Z),ie=Object(j.a)(T()),oe=Object(j.a)(G()),ce=Object(j.a)(U()),le=Object(j.a)($(),Z),se=Object(j.a)(M(),le,ce),ue=Object(j.a)(P(),se),de=Object(j.a)(R(),se),me=Object(j.a)(D()),ge=Object(j.a)(L(),ce),ve=Object(j.a)(x(),ce),be=Object(j.a)(C(),ce),pe=Object(j.a)(S(),ce),fe=Object(j.a)(q(),ce),Ee=Object(j.a)(I()),ke=Object(j.a)(w(),le),je=Object(j.a)(O(),le),he=Object(j.a)(y(),le),ye=Object(j.a)(h(),le),Oe=n(137),we=n(39),Ie=n.n(we),qe=n(62),Se=n(133),Ce=n(134),xe=n(138),Le=n(135),De=function(e){e.graphQLErrors&&e.graphQLErrors[0]?(console.log(e.graphQLErrors[0].message),e.graphQLErrors[0].stack&&console.log(e.graphQLErrors[0].stack)):(console.log(e.message),e.stack&&console.log(e.stack))},Re=(i.a.createContext(null),i.a.createContext(null),i.a.createContext(null)),Pe=function(){var e=Object(Se.a)(),t=Object(r.useState)(null),n=Object(s.a)(t,2),a=n[0],i=n[1],o=Object(Le.a)(ue,{variables:{token:window.localStorage.getItem("loggedChessUser")?window.localStorage.getItem("loggedChessUser"):window.sessionStorage.getItem("loggedChessUser")},onCompleted:function(e){g(e.getLoggedUser)},onError:function(e){De(e)}}),c=(Object(s.a)(o,1)[0],Object(Ce.a)(ue,{variables:{token:window.localStorage.getItem("loggedChessUser")?window.localStorage.getItem("loggedChessUser"):window.sessionStorage.getItem("loggedChessUser")},onError:function(e){De(e)}})),l=c.loading,u=c.data,d=c.error,m=Object(r.useCallback)(Object(qe.a)(Ie.a.mark((function t(){return Ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("logged out"),window.localStorage.removeItem("loggedChessUser"),window.sessionStorage.removeItem("loggedChessUser"),i(null),t.next=6,e.cache.reset();case 6:return t.abrupt("return");case 7:case"end":return t.stop()}}),t)}))),[]),g=Object(r.useCallback)((function(t,n){var a={getLoggedUser:t};n&&window.localStorage.setItem("loggedChessUser",t.token),window.sessionStorage.setItem("loggedChessUser",t.token),e.writeQuery({query:ue,data:a,variables:{token:t.token}}),i(t.token)}),[e]);Object(r.useEffect)((function(){u&&(g(u.getLoggedUser),i(u.getLoggedUser.token))}),[u,g]);var v=null;return l||d||!a||(v=e.readQuery({query:ue,variables:{token:a}})),{user:l||d||!a?null:v.getLoggedUser,userLoading:l,userError:d,setUser:g,removeUser:m}},Me=function(e){var t=Object(Se.a)(),n=Object(m.f)(),r=function(n,r){var i={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{sentRequests:e.sentRequests.filter((function(e){return e.id!==n.id})),receivedRequests:e.receivedRequests.filter((function(e){return e.id!==n.id})),friends:e.friends.find((function(e){return e.tag===n.to.tag}))?e.friends:e.friends.concat(r?{tag:n.from.tag}:{tag:n.to.tag})})};t.writeQuery({query:ue,data:i,variables:{token:e.token}})},i=function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{receivedInvites:n})};t.writeQuery({query:ue,data:r,variables:{token:e.token}})},o=function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{sentInvites:n})};t.writeQuery({query:ue,data:r,variables:{token:e.token}})};Object(xe.a)(ge,{variables:{userId:e?e.id:null},onError:function(e){console.log("virhe"),De(e)},onSubscriptionComplete:function(){console.log("Listening to incoming friend requests")},onSubscriptionData:function(n){var r=n.subscriptionData;console.log("Data from req reception:",r),function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{receivedRequests:e.receivedRequests.find((function(e){return e.id===n.id}))?e.receivedRequests:e.receivedRequests.concat(n)})};t.writeQuery({query:ue,data:r,variables:{token:e.token}})}(r.data.requestReceived)}}),Object(xe.a)(ve,{variables:{userId:e?e.id:null},onError:function(e){console.log("virhe"),De(e)},onSubscriptionComplete:function(){console.log("Listening to accepts to the reqs...")},onSubscriptionData:function(e){var t=e.subscriptionData;console.log("Data from req acception:",t),r(t.data.requestAccepted)}});var c=Object(Oe.a)(be,{onCompleted:function(n){!function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{sentRequests:e.sentRequests.find((function(e){return e.id===n.id}))?e.sentRequests:e.sentRequests.concat(n)})};t.writeQuery({query:ue,data:r,variables:{token:e.token}})}(n.sendFriendRequest)}}),l=Object(s.a)(c,2),u=l[0],d=l[1].data,g=Object(Oe.a)(pe,{onError:function(e){De(e)},onCompleted:function(e){r(e.acceptFriendRequest,!0)}}),v=Object(s.a)(g,2),b=v[0],p=v[1].data,f=Object(Oe.a)(fe,{onError:function(e){De(e)},onCompleted:function(n){!function(n){var r={getLoggedUser:Object(a.a)(Object(a.a)({},e),{},{receivedRequests:e.receivedRequests.filter((function(e){return e.id!==n.id}))})};t.writeQuery({query:ue,data:r,variables:{token:e.token}})}(n.declineFriendRequest)}}),E=Object(s.a)(f,2),k=E[0],j=E[1].data,h=Object(Oe.a)(Ee,{onError:function(e){De(e)}}),y=Object(s.a)(h,1)[0];Object(xe.a)(ke,{variables:{tag:e?e.tag:null},onError:function(e){console.log("virhe"),De(e)},onSubscriptionData:function(t){var n=t.subscriptionData;if(console.log("Data from inv reception:",n),!e.receivedInvites)return i([n.data.inviteReceived]),void console.log("were set to",[n.data.inviteReceived]);e.receivedInvites.find((function(e){return e.from===n.data.inviteReceived.from}))||i(e.receivedInvites.concat(n.data.inviteReceived))}}),Object(xe.a)(je,{variables:{tag:e?e.tag:null},onError:function(e){console.log("virhe"),De(e)},onSubscriptionData:function(t){var a=t.subscriptionData;console.log("Data from inv resolving:",a),e.sentInvites?o(e.sentInvites.filter((function(e){return e.to!==a.data.inviteResolved.to}))):o([]),"accepted"===a.data.inviteResolved.resolveStatus&&(n.push("/"),n.push("play/".concat(a.data.inviteResolved.game.id)))}});var O=Object(Oe.a)(he,{onCompleted:function(t){console.log("sent inv",t.sendGameInvite),e.receivedInvites&&e.receivedInvites.find((function(e){return e.from===t.sendGameInvite.to}))||(e.sentInvites?null!==t.sendGameInvite.resolveStatus||e.sentInvites.find((function(e){return e.to===t.sendGameInvite.to}))||o(e.sentInvites.concat(t.sendGameInvite)):o([t.sendGameInvite]))}}),w=Object(s.a)(O,1)[0],I=Object(Oe.a)(ye,{onError:function(e){De(e)},onCompleted:function(t){console.log("resolved inv",t.resolveGameInvite),e.receivedInvites?i(e.receivedInvites.filter((function(e){return e.from!==t.resolveGameInvite.from}))):i([]),"accepted"===t.resolveGameInvite.resolveStatus&&(n.push("/"),n.push("play/".concat(t.resolveGameInvite.game.id)))}});return{acceptReq:b,acceptReqData:p,sendReq:u,sendReqData:d,removeFriend:y,declineReq:k,declineReqData:j,sendGameInv:w,resolveGameInv:Object(s.a)(I,1)[0]}},$e=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),c=Object(s.a)(o,2),l=c[0],u=c[1],d=Object(r.useState)(!0),v=Object(s.a)(d,2),k=v[0],j=v[1],h=Object(r.useContext)(Re).setFeedback,y=Pe().setUser,O=Object(m.f)(),w=Object(Oe.a)(de,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message),h({message:e.message,severity:"error"}),u("")}}),I=Object(s.a)(w,2),q=I[0],S=I[1];return Object(r.useEffect)((function(){S.data&&(a(""),u(""),y(S.data.login,k),O.push("/"),window.location.reload(!0))}),[S.data,y,O,k]),i.a.createElement("div",null,i.a.createElement(g.a,{style:{padding:10}},i.a.createElement("h2",null,"Kirjaudu sis\xe4\xe4n"),i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),q({variables:{username:n,password:l}})}},i.a.createElement("div",null,i.a.createElement(b.a,{label:"K\xe4ytt\xe4j\xe4nimi",value:n,onChange:function(e){a(e.target.value)},name:"username"})),i.a.createElement("div",null,i.a.createElement(b.a,{label:"Salasana",type:"password",value:l,onChange:function(e){u(e.target.value)},name:"password"})),i.a.createElement("div",null,i.a.createElement(p.a,{control:i.a.createElement(f.a,{checked:k,onChange:function(){return j(!k)},name:"rememberMe",color:"primary"}),label:"Muista minut"})),i.a.createElement("div",null,i.a.createElement(E.a,{variant:"contained",color:"primary",type:"submit"},"Kirjaudu"))),i.a.createElement("div",null,"tai"),i.a.createElement("div",null,i.a.createElement(E.a,{variant:"contained",color:"primary",onClick:function(){return O.push("/register")}},"Luo uusi k\xe4ytt\xe4j\xe4"))))},Ue=n(251),Ge=n(252),Te=n(69),Ne=n(234),Fe=n(254),Qe=n(262),He=n(232),Ke=n(241),Ae=n(242),_e=n(243),Be=n(247),ze=n(248),Ve=n(244),We=n(245),Je=n(246),Ye=n(249),Xe=n(250),Ze=n(236),et=n(237),tt=n(238),nt=n(239),at=n(240),rt=n(263),it=n(260),ot=function(){var e=Object(r.useContext)(Re),t=e.feedback,n=e.setFeedback;return i.a.createElement(rt.a,{open:!!t,autoHideDuration:6e3,onClose:function(){return n(null)}},i.a.createElement(it.a,{onClose:function(){return n(null)},severity:t?t.severity:"info"},t?t.message:""))},ct=i.a.forwardRef((function(e,t){var n=e.sendReq,a=Object(r.useState)(!1),o=Object(s.a)(a,2),c=o[0],l=o[1],u=Object(r.useState)(""),d=Object(s.a)(u,2),m=d[0],g=d[1],v=Object(r.useContext)(Re).setFeedback;i.a.useImperativeHandle(t,(function(){return{setOpen:l}}));var p=function(){var e=Object(qe.a)(Ie.a.mark((function e(){return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({variables:{tag:m}});case 3:v({message:"Kaveripyynt\xf6 l\xe4hetetty",severity:"success"}),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("l\xf6ytys vrihe"),v({message:e.t0.message,severity:"error"});case 10:g("");case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return i.a.createElement("div",null,i.a.createElement(Ze.a,{open:c,onClose:function(){return l(!1)}},i.a.createElement(et.a,null,"Lis\xe4\xe4 kaveri"),i.a.createElement(tt.a,null,i.a.createElement(nt.a,null,"Kirjoita t\xe4h\xe4n kaverisi pelinimi."),i.a.createElement(b.a,{value:m,label:"Pelinimi",onChange:function(e){return g(e.target.value)}})),i.a.createElement(at.a,null,i.a.createElement(E.a,{onClick:function(){return l(!1)}},"Peruuta"),i.a.createElement(E.a,{onClick:function(){return p()}},"Lis\xe4\xe4")),i.a.createElement(tt.a,null,i.a.createElement(ot,null))))}));ct.displayName="AddFriendDialog";var lt=ct,st=i.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(s.a)(n,2),o=a[0],c=a[1],l=Pe(),u=l.user,d=l.removeUser,m=Me(u),g=m.acceptReq,v=m.declineReq,b=m.sendGameInv,p=m.resolveGameInv,f=m.sendReq,E=i.a.createRef(),k=function(){c(!0)};Object(r.useImperativeHandle)(t,(function(){return{openDrawer:k}}));var j=function(){var e=Object(qe.a)(Ie.a.mark((function e(t){return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.receivedInvites&&u.receivedInvites.find((function(e){return e.from===t}))){e.next=3;break}return e.next=3,b({variables:{tag:t}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(qe.a)(Ie.a.mark((function e(t,n){return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p({variables:{from:t,accepted:n}});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}();return u&&u.guest?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(Qe.a,{open:o,onClose:function(){return c(!1)},onOpen:function(){return c(!0)},anchor:"right"},i.a.createElement("div",{style:{width:"32vh"}},i.a.createElement(He.a,null,i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,{primary:u?"Kirjautuneena ".concat(u.tag):null})),i.a.createElement(_e.a,null),u&&0!==u.receivedRequests.length?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,{primary:"Kaveripyynn\xf6t"})),u.receivedRequests.map((function(e){return i.a.createElement(Ke.a,{key:e.id},i.a.createElement(Ae.a,{secondary:"K\xe4ytt\xe4j\xe4lt\xe4 ".concat(e.from.tag)}),i.a.createElement(Ne.a,{onClick:function(){return g({variables:{requestId:e.id}})}},i.a.createElement(Ve.a,null)),i.a.createElement(Ne.a,{onClick:function(){return v({variables:{requestId:e.id}})}},i.a.createElement(We.a,null)))})),i.a.createElement(_e.a,null)):null,i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,{primary:"Kaverit"})),u&&0!==u.friends.length?u.friends.map((function(e){return i.a.createElement(Ke.a,{key:e.tag},i.a.createElement(Ae.a,{secondary:e.tag}),i.a.createElement(Ne.a,{onClick:function(){return j(e.tag)}},i.a.createElement(Je.a,null)))})):i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,{secondary:"Sinulla ei ole viel\xe4 kavereita."})),i.a.createElement(_e.a,null),i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,{primary:"L\xe4hetetyt pelikutsut"})),u&&u.sentInvites?u.sentInvites.map((function(e){return i.a.createElement(Ke.a,{key:e.to},i.a.createElement(Ae.a,{secondary:"k\xe4ytt\xe4j\xe4lle ".concat(e.to)}))})):null,i.a.createElement(_e.a,null),i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,{primary:"Vastaanotetut pelikutsut"})),u&&u.receivedInvites?u.receivedInvites.map((function(e){return i.a.createElement(Ke.a,{key:e.from},i.a.createElement(Ae.a,{secondary:"k\xe4ytt\xe4j\xe4lt\xe4 ".concat(e.from)}),i.a.createElement(Ne.a,{onClick:function(){return h(e.from,!0)}},i.a.createElement(Ve.a,null)),i.a.createElement(Ne.a,{onClick:function(){return h(e.from,!1)}},i.a.createElement(We.a,null)))})):null,i.a.createElement(_e.a,null),i.a.createElement(Ke.a,{button:!0,onClick:function(){d(),console.log("has been removed"),c(!1),window.location.reload()},component:Be.a,to:"/"},i.a.createElement(ze.a,null,i.a.createElement(Ye.a,null)),i.a.createElement(Ae.a,{primary:"Kirjaudu ulos"})),i.a.createElement(Ke.a,{button:!0,onClick:function(){return E.current.setOpen(!0)}},i.a.createElement(ze.a,null,i.a.createElement(Xe.a,null)),i.a.createElement(Ae.a,{primary:"Lis\xe4\xe4 kaveri"})),i.a.createElement(Ke.a,null,i.a.createElement(Ae.a,{secondary:"Huom. kaverilistassa ei n\xe4y, onko kaveri paikalla shakkipeliss\xe4,\r ja pelikutsu ei saavu perille h\xe4nen ollessa poissa.\r Kaveripyynn\xf6n l\xe4hett\xe4minen onnistuu kyll\xe4, vaikka h\xe4n ei olisi paikalla."}))))),i.a.createElement(lt,{sendReq:f,ref:E}))}));st.displayName="ProfileDrawer";var ut,dt=st,mt=n(255),gt=function(){var e=Pe().user,t=i.a.createRef();return i.a.createElement(Ue.a,{position:"static"},i.a.createElement(Ge.a,null,i.a.createElement(u.a,{container:!0,alignItems:"center",justify:"space-between"},i.a.createElement(u.a,{item:!0},i.a.createElement(E.a,{color:"inherit",component:l.b,to:"/play"},"Pelaa"),i.a.createElement(E.a,{color:"inherit",component:l.b,to:"/info"},"Ohjeet")),i.a.createElement(u.a,{item:!0},i.a.createElement(Te.a,{variant:"subtitle2"},"Ongelmatilanteessa sivun uudelleenlaataaminen yleens\xe4 auttaa.")),i.a.createElement(u.a,{item:!0},!e||e.guest?i.a.createElement(E.a,{color:"inherit",component:l.b,to:"/login"},"Kirjaudu"):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ne.a,{onClick:function(){return t.current.openDrawer()}},i.a.createElement(Fe.a,{badgeContent:e?(e.receivedRequests?e.receivedRequests.length:0)+(e.receivedInvites?e.receivedInvites.length:0):0,color:"primary"},i.a.createElement(mt.a,{style:{color:"white"}})))))),i.a.createElement(dt,{ref:t})))},vt=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),c=Object(s.a)(o,2),l=c[0],u=c[1],d=Object(r.useState)(""),v=Object(s.a)(d,2),p=v[0],f=v[1],k=Object(r.useState)(""),j=Object(s.a)(k,2),h=j[0],y=j[1],O=Object(m.f)(),w=Object(Oe.a)(me,{onError:function(e){console.log(e.graphQLErrors[0].message),window.alert(e.graphQLErrors[0].message)}}),I=Object(s.a)(w,2),q=I[0],S=I[1];Object(r.useEffect)((function(){S.data&&(a(""),u(""),y(""),window.alert("K\xe4ytt\xe4j\xe4 luotu onnistuneesti."),O.push("/"))}),[S.data,O]);var C={background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:"20px"};return i.a.createElement(g.a,{style:C},i.a.createElement("h2",null,"Luo uusi k\xe4ytt\xe4j\xe4"),i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),q({variables:{user:{username:n,password:l,tag:h}}})}},i.a.createElement("div",null,i.a.createElement(b.a,{label:"K\xe4ytt\xe4j\xe4nimi",onChange:function(e){a(e.target.value)},error:0!==n.length&&n.length<2,helperText:0!==n.length&&n.length<2?"Liian lyhyt":"K\xe4ytt\xe4j\xe4nimesi ei n\xe4y muille pelaajille.",required:!0})),i.a.createElement("div",null,i.a.createElement(b.a,{label:"Pelinimi",onChange:function(e){y(e.target.value)},helperText:"Nimi joka n\xe4kyy muille pelaajille.",required:!0})),i.a.createElement("div",null,i.a.createElement(b.a,{label:"Salasana",type:"password",onChange:function(e){u(e.target.value)},error:l.length<8&&""!==l,helperText:l.length<8&&""!==l?"Liian lyhyt":null,required:!0}),i.a.createElement("div",{style:{paddingTop:20,paddingBottom:10}},i.a.createElement("strong",null,"\xc4l\xe4 k\xe4yt\xe4 samaa salasanaa, joka sinulla on muilla nettisivuilla. "),"Olen vain opiskelija, ja t\xe4m\xe4 on ensimm\xe4inen nettiprojektini, joten en voi taata sivuston tietoturvallisuutta.")),i.a.createElement("div",null,i.a.createElement(b.a,{label:"Salasana uudelleen",type:"password",onChange:function(e){f(e.target.value)},error:p!==l,helperText:p!==l?"Salasanat eiv\xe4t vastaa toisiaan.":null,required:!0})),i.a.createElement("div",null,i.a.createElement(E.a,{variant:"contained",color:"primary",type:"submit"},"Luo k\xe4ytt\xe4j\xe4"))))},bt=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Pe().user,c=Object(Oe.a)(oe,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message)}}),l=Object(s.a)(c,2),u=l[0],d=l[1];return Object(r.useEffect)((function(){if(d.data){var e=d.data.createGame.id;a("".concat(window.location,"/").concat(e))}}),[d.data]),i.a.createElement("div",null,i.a.createElement(g.a,{style:{background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:10}},n?i.a.createElement(i.a.Fragment,null,i.a.createElement(g.a,{style:{background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:10}},"Jaa t\xe4m\xe4 linkki kaverillesi. Sen kautta p\xe4\xe4set pelaamaan.","  ",i.a.createElement(Be.a,{href:n},n)),i.a.createElement(Te.a,{variant:"subtitle2"},"voit my\xf6s kirjautua sis\xe4\xe4n ja kutsua kaverisi peliin profiilivalikosta.")):i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{variant:"contained",onClick:function(){o?u():console.log("Sinun t\xe4ytyy kirjautua ennen kuin pelaat")}},"Peli linkin kautta"),i.a.createElement(Te.a,{variant:"subtitle2"},"tai kirjaudu sis\xe4\xe4n ja kutsu kaverisi peliin profiilivalikosta."))))},pt=n(145),ft=n.n(pt),Et=n(146),kt=n.n(Et),jt=n(147),ht=n.n(jt),yt=n(148),Ot=n.n(yt),wt=n(149),It=n.n(wt),qt=n(150),St=n.n(qt),Ct=n(151),xt=n.n(Ct),Lt=n(152),Dt=n.n(Lt),Rt=n(153),Pt=n.n(Rt),Mt=n(154),$t=n.n(Mt),Ut=n(155),Gt=n.n(Ut),Tt=n(156),Nt=n.n(Tt),Ft={width:65,height:65,verticalAlign:"middle"},Qt=function(e,t){return"king"===e&&"black"===t?ft.a:"queen"===e&&"black"===t?kt.a:"bishop"===e&&"black"===t?Ot.a:"rook"===e&&"black"===t?ht.a:"knight"===e&&"black"===t?It.a:"pawn"===e&&"black"===t?St.a:"king"===e&&"white"===t?xt.a:"queen"===e&&"white"===t?Dt.a:"bishop"===e&&"white"===t?$t.a:"rook"===e&&"white"===t?Pt.a:"knight"===e&&"white"===t?Gt.a:"pawn"===e&&"white"===t?Nt.a:void 0},Ht=function(e){var t=e.style,n=e.id,o=e.side,c=e.type,l=Object(r.useState)(1),u=Object(s.a)(l,1)[0];return i.a.createElement("img",{style:Object(a.a)(Object(a.a)({},t),{},{opacity:u}),className:"piece",draggable:"false",type:n,side:o,id:n,src:Qt(c,o),alt:"sprite"})},Kt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ft);return i.a.createElement(Ht,{style:r,id:n,side:t,type:"king"},"K")},At=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ft);return i.a.createElement(Ht,{style:r,id:n,side:t,type:"queen"},"D")},_t=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ft);return i.a.createElement(Ht,{style:r,id:n,side:t,type:"rook"},"T")},Bt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ft);return i.a.createElement(Ht,{style:r,id:n,side:t,type:"knight"},"R")},zt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ft);return i.a.createElement(Ht,{style:r,id:n,side:t,type:"bishop"},"L")},Vt=function(e){var t=e.side,n=e.id,r=Object(a.a)({},Ft);return i.a.createElement(Ht,{style:r,id:n,side:t,type:"pawn"},"S")},Wt=function(e){var t=e.color,n=(e.makeMove,e.location),a=e.piece,o=(e.dragHelperMap,e.id),c=e.highlight,l=Object(r.useMemo)((function(){return"rgb(".concat("white"===t?"29, 240, 201":"25, 145, 123",")")}),[t]),u=Object(r.useState)(l),d=Object(s.a)(u,2),m=d[0],g=d[1];Object(r.useEffect)((function(){g(c?"rgb(".concat("17, 209, 97",")"):l)}),[c,l]);var v,b={height:70,width:70,backgroundColor:m,textAlign:"center",background:"radial-gradient(".concat(m,", ").concat(l,")")};if(a)switch(a.type){case"pawn":v=i.a.createElement(Vt,{side:a.side,id:8*n.row+n.column});break;case"rook":v=i.a.createElement(_t,{side:a.side,id:8*n.row+n.column});break;case"knight":v=i.a.createElement(Bt,{side:a.side,id:8*n.row+n.column});break;case"bishop":v=i.a.createElement(zt,{side:a.side,id:8*n.row+n.column});break;case"queen":v=i.a.createElement(At,{side:a.side,id:8*n.row+n.column});break;case"king":v=i.a.createElement(Kt,{side:a.side,id:8*n.row+n.column});break;default:v=null}return v?i.a.createElement("td",{id:o,style:b,className:"square"},v):i.a.createElement("td",{id:o,style:b,className:"square"})},Jt=function(e){var t=e.boardAlignment,n=e.board,a=e.makeMove,r=e.handleClick,o=e.chosenPiece,c=new Map;n.forEach((function(e,t){e.forEach((function(e,n){c.set(8*t+n,e)}))}));var l=Array.from(Array(8),(function(e,t){for(var n=new Array(8),a=0;a<8;a++)n[a]=(t+a)%2===0?{piece:null,color:"white"}:{piece:null,color:"black"};return n})),s={height:560,width:560,borderStyle:"solid",borderColor:"black",borderWidth:"2px",background:"cyan"};return i.a.createElement("table",{className:"board",onClick:r,cellSpacing:"0",style:s},i.a.createElement("tbody",null,"white"===t?n.map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,8-t),e.map((function(e,n){var r=!1;return o&&(o.availableMoves.forEach((function(e){e.newLocation.row===t&&e.newLocation.column===n&&(r=!0)})),o.location.row===t&&o.location.column===n&&(r=!0)),i.a.createElement(Wt,{key:8*t+n,id:8*t+n,color:l[t][n].color,makeMove:a,location:{row:t,column:n},piece:e,dragHelperMap:c,highlight:r})})))})):n.map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,t+1),e.map((function(e,r){var s=!1;return o&&(o.availableMoves.forEach((function(e){e.newLocation.row===7-t&&e.newLocation.column===7-r&&(s=!0)})),o.location.row===7-t&&o.location.column===7-r&&(s=!0)),i.a.createElement(Wt,{key:8*(7-t)+(7-r),id:8*(7-t)+(7-r),color:l[7-t][7-r].color,makeMove:a,location:{row:7-t,column:7-r},piece:n[7-t][7-r],dragHelperMap:c,highlight:s})})))})),"white"===t?i.a.createElement("tr",null,i.a.createElement("td",null),i.a.createElement("td",null,"A"),i.a.createElement("td",null,"B"),i.a.createElement("td",null,"C"),i.a.createElement("td",null,"D"),i.a.createElement("td",null,"E"),i.a.createElement("td",null,"F"),i.a.createElement("td",null,"G"),i.a.createElement("td",null,"H")):i.a.createElement("tr",null,i.a.createElement("td",null),i.a.createElement("td",null,"H"),i.a.createElement("td",null,"G"),i.a.createElement("td",null,"F"),i.a.createElement("td",null,"E"),i.a.createElement("td",null,"D"),i.a.createElement("td",null,"C"),i.a.createElement("td",null,"B"),i.a.createElement("td",null,"A"))))},Yt=n(256),Xt=Object(Yt.a)({turnText:{background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:10,height:"8vh",width:"40vh",textAlign:"center"}}),Zt=function(e){var t=e.game,n=t.check,a=t.currentPlayer,o=t.gameOver,c=t.promotionPlayerID,l=t.winner,u=t.blackPlayer,d=e.promote,m=Pe(),v=m.user,b=m.userLoading,p=Object(r.useState)("Odotetaan, ett\xe4 vastustaja liityy peliin."),f=Object(s.a)(p,2),k=f[0],j=f[1],h=Object(r.useState)(!1),y=Object(s.a)(h,2),O=y[0],w=y[1],I=Xt();return Object(r.useEffect)((function(){v&&(u?o?(l===v.id?j("Voitit pelin! Onneksi olkoon!"):j("Ootko paska ku h\xe4visit :D"),w(!0)):v.id===a?(n&&n.threatenedPlayer===v.id?j("On sinun vuorosi. Shakki!"):j("On sinun vuorosi."),w(!0)):(n&&n.threatenedPlayer!==v.id?j("Odotetaan vastustajan siirtoa. Shakki!"):j("Odotetaan vastustajan siirtoa."),w(!1)):(w(!1),j("Odotetaan, ett\xe4 vastustaja liityy peliin.")))}),[j,u,o,a,v,l,n]),b?"loading...":i.a.createElement("div",{className:"gameText"},i.a.createElement(g.a,{className:I.turnText},i.a.createElement(Te.a,{variant:O?"h4":"subtitle1"},k)),i.a.createElement("div",null,v.id===c?i.a.createElement("div",null,"Valitse nappula, joksi haluat muuttaa sotilaan"," ",i.a.createElement(E.a,{onClick:function(){return d("queen")}},"Kuningatar"),i.a.createElement(E.a,{onClick:function(){return d("knight")}},"Ratsu")):null))},en=function(e){return 0===e.column?"A".concat(8-e.row):1===e.column?"B".concat(8-e.row):2===e.column?"C".concat(8-e.row):3===e.column?"D".concat(8-e.row):4===e.column?"E".concat(8-e.row):5===e.column?"F".concat(8-e.row):6===e.column?"G".concat(8-e.row):7===e.column?"H".concat(8-e.row):"ErrorLocation"},tn=function(e){var t=e.move,n=e.emphasize,a={borderLeftStyle:"solid",borderColor:"blue",borderWidth:"1px",borderLeftWidth:"10px",padding:10,background:"cyan"},r={borderLeftStyle:"solid",borderColor:"blue",borderWidth:"1px",borderLeftWidth:"5px",margin:5,background:"cyan"},o=n?{height:60,width:60}:void 0;return"OrdinaryMove"===t.__typename?i.a.createElement(g.a,{style:n?a:r},i.a.createElement("img",{style:o,className:"piece",draggable:"false",src:Qt(t.piece.type,t.piece.side),alt:t.piece.type}),en(t.newLocation)):"CastlingMove"===t.__typename?i.a.createElement(g.a,{style:n?a:r},"Tornitus"):"PromotionMove"===t.__typename?i.a.createElement(g.a,{style:n?a:r},en(t.promotedPiece.location),i.a.createElement("img",{style:o,className:"piece",draggable:"false",src:Qt(t.promotedPiece.type,t.promotedPiece.side),alt:t.promotedPiece.type}),"---\x3e",i.a.createElement("img",{style:o,className:"piece",draggable:"false",src:Qt(t.promotedTo,t.promotedPiece.side),alt:t.promotedPiece.type})):"SkipMove"===t.__typename?i.a.createElement(g.a,{style:n?a:r},"Vuoro ohitettu."):i.a.createElement(g.a,null,"Error")},nn=function(e){var t=e.moveHistory;return i.a.createElement("div",{className:"moveHistory",style:{overflowY:"scroll",height:350}},t.map((function(e,n){return e=t[t.length-1-n],0!==n?i.a.createElement(tn,{move:e,key:n}):null})))},an=function(e){var t=e.moveHistory,n=Object(r.useState)(!1),a=Object(s.a)(n,2),o=a[0],c=a[1],l={background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:"20px"};if(0===t.length)return i.a.createElement(g.a,{style:l},i.a.createElement(Te.a,{variant:"subtitle2"},"Siirtoja ei ole viel\xe4 tehty"));var u=t[t.length-1];return i.a.createElement(g.a,{style:l},i.a.createElement(Te.a,{variant:"h5"},"Viimeisin siirto"),i.a.createElement(tn,{move:u,emphasize:!0}),i.a.createElement(E.a,{variant:"contained",onClick:function(){return c(!o)},color:"primary"},"N\xe4yt\xe4 kaikki siirrot"),o?i.a.createElement(nn,{moveHistory:t}):null)},rn=function(e){var t=e.squareNode,n=e.pieceToMove,a=e.clickedPiece,r=e.game,i=e.user;return!t.style.background.includes("radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("25, 145, 123","))"))&&!t.style.background.includes("radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("29, 240, 201","))"))||a&&a.id===n.id||r.gameOver||r.promotionPlayerID||i.id!==r.currentPlayer},on=function(e){var t=e.clickedPiece,n=e.game,a=e.user;return a.id===n.currentPlayer&&t.side===(n.whitePlayer===a.id?"white":"black")&&!n.promotionPlayerID&&!n.gameOver},cn=function(e){var t=e.skipTurn,n=e.disabled,a=Object(r.useState)(!1),o=Object(s.a)(a,2),c=o[0],l=o[1],u={background:"linear-gradient(135deg, rgb(".concat("29, 240, 201","), rgb(").concat("25, 145, 123","))"),padding:"20px"};return i.a.createElement(g.a,{style:u},c?i.a.createElement("div",null,i.a.createElement(Te.a,{variant:"subtitle2"},"Vahvista ohitus?"),i.a.createElement(E.a,{variant:"outlined",size:"small",onClick:function(){t(),l(!1)},disabled:n},"Ohita"),i.a.createElement(E.a,{variant:"outlined",size:"small",onClick:function(){l(!1)}},"Peruuta")):i.a.createElement(E.a,{variant:"outlined",size:"small",onClick:function(){return l(!0)},disabled:n},"Ohita vuoro"))},ln=Object(Yt.a)({game:{}}),sn=function(){var e=function(){var e=Object(Se.a)(),t=Object(m.g)().id,n=function(n){var a=e.readQuery({query:ee,variables:{gameId:t}});a={getGame:n.gameStateUpdated},e.writeQuery({query:ee,data:a,variables:{id:t}})},a=Object(Ce.a)(ee,{variables:{gameId:t},onError:function(e){De(e)}}),i=Object(Oe.a)(ie,{onError:function(e){De(e)}}),o=Object(s.a)(i,1)[0],c=Object(Oe.a)(re),l=Object(s.a)(c,1)[0],u=Object(Oe.a)(te,{variables:{gameId:t},onError:function(e){De(e)}}),d=Object(s.a)(u,1)[0],g=Object(Oe.a)(ae,{variables:{gameId:t},onError:function(e){De(e)},onCompleted:function(e){n(e)}}),v=Object(s.a)(g,1)[0];Object(xe.a)(ne,{onSubscriptionData:function(e){var t=e.subscriptionData;n(t.data)},variables:{gameId:t}}),Object(r.useEffect)((function(){v()}),[v]);return{game:a.loading||a.error?null:a.data.getGame,gameLoading:a.loading,gameError:a.error,promote:function(e){l({variables:{gameId:t,pieceType:e}})},makeMove:function(e){var n=e.piece,a=e.oldLocation,r=e.newLocation;return o({variables:{move:{piece:n,oldLocation:a,newLocation:r,gameId:t}}})},skipTurn:d}}(),t=e.game,n=e.gameLoading,a=e.gameError,o=e.makeMove,c=e.promote,l=e.skipTurn,g=Pe(),v=g.user,b=g.userLoading,p=Object(r.useState)(null),f=Object(s.a)(p,2),E=f[0],k=f[1],j=ln();if(n||b)return i.a.createElement(d.a,null);if(!t)return a.toString();var h=t.board,y=t.whitePlayer,O=t.moveHistory,w=t.currentPlayer,I=t.promotionPlayerID,q=t.check,S=t.blackPlayer,C=function(){var e=Object(qe.a)(Ie.a.mark((function e(n){var a,r,i,c,l,s,u,d,m,g,b,p;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),"piece"!==(a=n.target).className){e.next=27;break}if(r=h[Math.floor(Number(a.id)/8)][Number(a.id)%8],!E){e.next=24;break}if(!rn({squareNode:a.parentNode,pieceToMove:E,clickedPiece:r,user:v,game:t})){e.next=8;break}return k(null),e.abrupt("return");case 8:return i={type:E.type,side:E.side},c={row:E.location.row,column:E.location.column},l={row:r.location.row,column:r.location.column},e.prev=11,e.next=14,o({piece:i,oldLocation:c,newLocation:l});case 14:(s=e.sent).data.makeMove.lastMove.success||console.log(s.data.makeMove.lastMove.message),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),De(e.t0);case 21:k(null),e.next=25;break;case 24:on({clickedPiece:r,game:t,user:v})&&k(r);case 25:e.next=54;break;case 27:if("square"!==a.className){e.next=53;break}if((u=a.firstChild)&&(d=h[Math.floor(Number(u.id)/8)][Number(u.id)%8]),!E){e.next=50;break}if(!rn({squareNode:a,pieceToMove:E,clickedPiece:d,user:v,game:t})){e.next=34;break}return k(null),e.abrupt("return");case 34:return m={type:E.type,side:E.side},g={row:E.location.row,column:E.location.column},b={row:Math.floor(Number(a.id)/8),column:Number(a.id)%8},e.prev=37,e.next=40,o({piece:m,oldLocation:g,newLocation:b});case 40:(p=e.sent).data.makeMove.lastMove.success||console.log(p.data.makeMove.lastMove.message),e.next=47;break;case 44:e.prev=44,e.t1=e.catch(37),De(e.t1);case 47:k(null),e.next=51;break;case 50:d&&on({clickedPiece:d,game:t,user:v})&&k(d);case 51:e.next=54;break;case 53:k(null);case 54:case"end":return e.stop()}}),e,null,[[11,18],[37,44]])})));return function(t){return e.apply(this,arguments)}}();return i.a.createElement(u.a,{container:!0,direction:"row",justify:"center",className:j.game,spacing:2,wrap:"wrap"},i.a.createElement(u.a,{item:!0,xs:3,lg:2},i.a.createElement(cn,{skipTurn:l,disabled:v.id!==w||null!==I||null!==q||null===y||null===S})),i.a.createElement(u.a,{container:!0,item:!0,xs:10,lg:6,direction:"column",alignItems:"center"},i.a.createElement(Jt,{board:h,boardAlignment:v.id===y?"white":"black",makeMove:o,handleClick:C,chosenPiece:E}),i.a.createElement(Zt,{game:t,promote:c})),i.a.createElement(u.a,{item:!0,xs:3,lg:3},i.a.createElement(an,{moveHistory:O})))},un=n(258),dn=Object(Yt.a)({root:{height:"100%"}}),mn=function(){var e=Pe().user,t=dn(),n=Object(r.useState)(null),a=Object(s.a)(n,2),o=a[0],c=a[1];return i.a.createElement(Re.Provider,{value:{feedback:o,setFeedback:c}},i.a.createElement(un.a,{classes:t},i.a.createElement(u.a,{container:!0,direction:"column",alignItems:"center",justify:"space-between",classes:t,wrap:"nowrap"},i.a.createElement(gt,null),e?i.a.createElement(m.c,null,i.a.createElement(m.a,{path:"/play/:id"},i.a.createElement(sn,null)),i.a.createElement(m.a,{path:"/play"},i.a.createElement(bt,null)),i.a.createElement(m.a,{path:"/login"},i.a.createElement($e,null)),i.a.createElement(m.a,{path:"/register"},i.a.createElement(vt,null))):i.a.createElement(d.a,null),i.a.createElement(ot,null),i.a.createElement(v,null))))},gn=n(77),vn=n(100),bn=n(101),pn=n(102),fn=n(136),En=n(158),kn=n(157),jn=n(159),hn=Object(En.a)((function(e,t){var n=t.headers,r=sessionStorage.getItem("loggedChessUser");return{headers:Object(a.a)(Object(a.a)({},n),{},{authorization:r?"bearer ".concat(r):null})}})),yn=window.location;ut="https:"===yn.protocol?"wss:":"ws:",ut+="//"+yn.host,console.log("".concat(ut,"/graphql"));var On=new gn.a({uri:"/graphql"}),wn=new jn.a({uri:"".concat(ut,"/graphql"),options:{reconnect:!0,connectionParams:{authToken:sessionStorage.getItem("loggedChessUser")?"bearer ".concat(sessionStorage.getItem("loggedChessUser")):null}}}),In=Object(vn.a)((function(e){var t=e.query,n=Object(kn.a)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),wn,hn.concat(On)),qn=new bn.a({cache:new pn.a,link:In,connectToDevTools:!0});c.a.render(i.a.createElement(fn.a,{client:qn},i.a.createElement(l.a,null,i.a.createElement(mn,null))),document.getElementById("root"))}},[[175,1,2]]]);
//# sourceMappingURL=main.c3babb58.chunk.js.map