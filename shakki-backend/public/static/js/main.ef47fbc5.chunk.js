(this["webpackJsonpshakki-frontend"]=this["webpackJsonpshakki-frontend"]||[]).push([[0],{125:function(e,a,n){e.exports=n.p+"static/media/blackking.66e1bcad.svg"},126:function(e,a,n){e.exports=n.p+"static/media/blackqueen.7b3e33e4.svg"},127:function(e,a,n){e.exports=n.p+"static/media/blackrook.96872a66.svg"},128:function(e,a,n){e.exports=n.p+"static/media/blackbishop.1f3b8d1a.svg"},129:function(e,a,n){e.exports=n.p+"static/media/blackknight.d39f1d02.svg"},130:function(e,a,n){e.exports=n.p+"static/media/blackpawn.1c52d8c4.svg"},131:function(e,a,n){e.exports=n.p+"static/media/whiteking.250510ff.svg"},132:function(e,a,n){e.exports=n.p+"static/media/whitequeen.4320a2dd.svg"},133:function(e,a,n){e.exports=n.p+"static/media/whiterook.095b1a06.svg"},134:function(e,a,n){e.exports=n.p+"static/media/whitebishop.09004fd2.svg"},135:function(e,a,n){e.exports=n.p+"static/media/whiteknight.e6294efe.svg"},136:function(e,a,n){e.exports=n.p+"static/media/whitepawn.d69014fb.svg"},152:function(e,a,n){e.exports=n(173)},173:function(e,a,n){"use strict";n.r(a);var t=n(40),r=n(0),o=n.n(r),i=n(19),c=n.n(i),l=n(50),s=n(58),u=function(){return o.a.createElement("div",null,"Student project for Full Stack open 2020")},d=n(15),m=n(210),g=n(203),p=n(211),b=n(205),v=n(43),f=n(26);function k(){var e=Object(v.a)(["\n  mutation addUser($user: NewUserInput!) {\n    addUser(\n      user: $user\n    ) {\n      username\n      tag\n      id\n      friends {\n        tag\n      }\n    }\n  }\n"]);return k=function(){return e},e}function h(){var e=Object(v.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(\n      username: $username,\n      password: $password\n    ) {\n      username\n      tag\n      friends {\n        tag\n      }\n      token\n      guest\n      id\n    }\n  }\n"]);return h=function(){return e},e}function E(){var e=Object(v.a)(["\n  query getLoggedUser($token: String) {\n    getLoggedUser(\n      token: $token\n    ) {\n      username\n      tag\n      friends {\n        tag\n      }\n      id\n      token\n      guest\n    }\n  }\n"]);return E=function(){return e},e}function w(){var e=Object(v.a)(["\n  mutation createGame {\n    createGame {\n      board {\n        type\n        side\n      }\n      id\n    }\n  }\n"]);return w=function(){return e},e}function j(){var e=Object(v.a)(["\n  mutation makeMove($move: MoveInput!) {\n    makeMove(\n      move: $move\n    ) {\n      lastMove {\n        success\n        message\n      }\n    }\n  }\n"]);return j=function(){return e},e}function y(){var e=Object(v.a)(["\n  mutation promote($gameId: String!, $pieceType: String!) {\n    promote(\n      gameId: $gameId,\n      pieceType: $pieceType\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function O(){var e=Object(v.a)(["\n  mutation joinGame($gameId: String!) {\n    joinGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return O=function(){return e},e}function S(){var e=Object(v.a)(["\n  subscription gameStateUpdated($gameId: String!) {\n    gameStateUpdated(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return S=function(){return e},e}function L(){var e=Object(v.a)(["\n  query getGame($gameId: String!) {\n    getGame(\n      gameId: $gameId\n    ) {\n      ...gameStateDetails\n    }\n  }\n  ","\n"]);return L=function(){return e},e}function M(){var e=Object(v.a)(["\n  fragment gameStateDetails on Game {\n    board {\n        type\n        side\n        id\n        location {\n          row\n          column\n        }\n        availableMoves {\n          newLocation {\n            row\n            column\n          }\n        }\n      }\n      id\n      currentPlayer\n      whitePlayer\n      blackPlayer\n      winner\n      gameOver\n      promotionPlayerID\n      check {\n        threatenedPlayer\n        movesAvailable {\n          piece {\n            type\n            side\n            id\n          }\n          newLocation {\n            row\n            column\n          }\n        }\n      }\n      moveHistory {\n        ... on OrdinaryMove {\n          piece {\n            type\n            side\n            id\n            lastLocation {\n              row\n              column\n            }\n          }\n          oldLocation {\n            row\n            column\n          }\n          newLocation {\n            row\n            column\n          }\n        }\n        ... on CastlingMove {\n          piece {\n            type\n            side\n            id\n            lastLocation {\n              row\n              column\n            }\n          }\n          castledPiece {\n            type\n            side\n            id\n            lastLocation {\n              row\n              column\n            }\n          }\n        }\n      }\n  }\n"]);return M=function(){return e},e}var x,I,N=Object(f.a)(M()),C=Object(f.a)(L(),N),q=Object(f.a)(S(),N),D=Object(f.a)(O(),N),U=Object(f.a)(y(),N),P=Object(f.a)(j()),$=Object(f.a)(w()),T=Object(f.a)(E()),Q=Object(f.a)(h()),G=Object(f.a)(k()),A=n(117),K=n(113),H=n(114),J=n(118),B=n(115),R=function(e){e.graphQLErrors&&e.graphQLErrors[0]?(console.log(e.graphQLErrors[0].message),e.graphQLErrors[0].stack&&console.log(e.graphQLErrors[0].stack)):(console.log(e.message),e.stack&&console.log(e.stack))},V=function(){var e=Object(K.a)(),a=Object(r.useState)(null),n=Object(d.a)(a,2),t=n[0],o=n[1],i=Object(B.a)(T,{variables:{token:window.localStorage.getItem("loggedChessUser")?window.localStorage.getItem("loggedChessUser"):window.sessionStorage.getItem("loggedChessUser")},onCompleted:function(e){p(e.getLoggedUser)},onError:function(e){R(e)}}),c=Object(d.a)(i,1)[0],l=Object(H.a)(T,{variables:{token:window.localStorage.getItem("loggedChessUser")?window.localStorage.getItem("loggedChessUser"):window.sessionStorage.getItem("loggedChessUser")},onError:function(e){R(e)}}),s=l.loading,u=l.data,m=l.error,g=Object(r.useCallback)((function(){console.log("logged out"),window.localStorage.removeItem("loggedChessUser"),window.sessionStorage.removeItem("loggedChessUser"),o(null),c()}),[c]),p=Object(r.useCallback)((function(a,n){var t={getLoggedUser:a};n&&(console.log("localStorageen meni"),window.localStorage.setItem("loggedChessUser",a.token)),window.sessionStorage.setItem("loggedChessUser",a.token),e.writeQuery({query:T,data:t,variables:{token:a.token}})}),[e]);Object(r.useEffect)((function(){u&&(p(u.getLoggedUser),o(u.getLoggedUser.token))}),[u,p]);var b=null;return s||m||!t||(b=e.readQuery({query:T,variables:{token:t}})),{user:s||m||!t?null:b.getLoggedUser,userLoading:s,userError:m,setUser:p,removeUser:g}},z=function(){var e=Object(r.useState)(""),a=Object(d.a)(e,2),n=a[0],t=a[1],i=Object(r.useState)(""),c=Object(d.a)(i,2),l=c[0],u=c[1],v=Object(r.useState)(!0),f=Object(d.a)(v,2),k=f[0],h=f[1],E=V().setUser,w=Object(s.f)(),j=Object(A.a)(Q,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message),u("")}}),y=Object(d.a)(j,2),O=y[0],S=y[1];return Object(r.useEffect)((function(){S.data&&(t(""),u(""),E(S.data.login,k),w.push("/"))}),[S.data,E,w,k]),o.a.createElement("div",null,o.a.createElement("h2",null,"Kirjaudu sis\xe4\xe4n"),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),O({variables:{username:n,password:l}})}},o.a.createElement("div",null,o.a.createElement(m.a,{label:"K\xe4ytt\xe4j\xe4nimi",onChange:function(e){t(e.target.value)},name:"username"})),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Salasana",type:"password",onChange:function(e){u(e.target.value)},name:"password"})),o.a.createElement("div",null,o.a.createElement(g.a,{control:o.a.createElement(p.a,{checked:k,onChange:function(){return h(!k)},name:"rememberMe",color:"primary"}),label:"Muista minut"})),o.a.createElement("div",null,o.a.createElement(b.a,{variant:"contained",color:"primary",type:"submit"},"Kirjaudu"))),o.a.createElement("div",null,"tai"),o.a.createElement("div",null,o.a.createElement(b.a,{variant:"contained",color:"primary",onClick:function(){return w.push("/register")}},"Luo uusi k\xe4ytt\xe4j\xe4")))},F=n(206),W=n(207),X=n(204),Y=function(){var e=V();e.user,e.removeUser;return o.a.createElement(F.a,{position:"static"},o.a.createElement(W.a,null,o.a.createElement(X.a,{edge:"start",color:"inherit","aria-label":"menu"}),o.a.createElement(b.a,{color:"inherit",component:l.b,to:"/play"},"Pelaa"),o.a.createElement(b.a,{color:"inherit",component:l.b,to:"/info"},"Ohjeet")))},Z=function(){var e=Object(r.useState)(""),a=Object(d.a)(e,2),n=a[0],t=a[1],i=Object(r.useState)(""),c=Object(d.a)(i,2),l=c[0],u=c[1],g=Object(r.useState)(""),p=Object(d.a)(g,2),v=p[0],f=p[1],k=Object(r.useState)(""),h=Object(d.a)(k,2),E=h[0],w=h[1],j=Object(s.f)(),y=Object(A.a)(G,{onError:function(e){console.log(e.graphQLErrors[0].message),window.alert(e.graphQLErrors[0].message)}}),O=Object(d.a)(y,2),S=O[0],L=O[1];return Object(r.useEffect)((function(){L.data&&(t(""),u(""),w(""),window.alert("K\xe4ytt\xe4j\xe4 luotu onnistuneesti."),j.push("/"))}),[L.data,j]),o.a.createElement("div",null,o.a.createElement("h2",null,"Luo uusi k\xe4ytt\xe4j\xe4"),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),S({variables:{user:{username:n,password:l,tag:E}}})}},o.a.createElement("div",null,o.a.createElement(m.a,{label:"K\xe4ytt\xe4j\xe4nimi",onChange:function(e){t(e.target.value)},error:0!==n.length&&n.length<2,helperText:0!==n.length&&n.length<2?"Liian lyhyt":"K\xe4ytt\xe4j\xe4nimesi ei n\xe4y muille pelaajille.",required:!0})),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Pelinimi",onChange:function(e){w(e.target.value)},helperText:"Nimi joka n\xe4kyy muille pelaajille.",required:!0})),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Salasana",type:"password",onChange:function(e){u(e.target.value)},error:l.length<8&&""!==l,helperText:l.length<8&&""!==l?"Liian lyhyt":null,required:!0}),o.a.createElement("div",{style:{paddingTop:20,paddingBottom:10}},o.a.createElement("strong",null,"\xc4l\xe4 k\xe4yt\xe4 samaa salasanaa, joka sinulla on muilla nettisivuilla. "),"Olen vain opiskelija, ja t\xe4m\xe4 on ensimm\xe4inen nettiprojektini, joten en voi taata sivuston tietoturvallisuutta.")),o.a.createElement("div",null,o.a.createElement(m.a,{label:"Salasana uudelleen",type:"password",onChange:function(e){f(e.target.value)},error:v!==l,helperText:v!==l?"Salasanat eiv\xe4t vastaa toisiaan.":null,required:!0})),o.a.createElement("div",null,o.a.createElement(b.a,{variant:"contained",color:"primary",type:"submit"},"Luo k\xe4ytt\xe4j\xe4"))))},_=n(208),ee=function(){var e=Object(r.useState)(null),a=Object(d.a)(e,2),n=a[0],t=a[1],i=V().user,c=Object(A.a)($,{onError:function(e){e.graphQLErrors&&e.graphQLErrors[0]?console.log(e.graphQLErrors[0].message):console.log(e.message)}}),l=Object(d.a)(c,2),s=l[0],u=l[1];return Object(r.useEffect)((function(){if(u.data){var e=u.data.createGame.id;t("".concat(window.location,"/").concat(e))}}),[u.data]),o.a.createElement("div",null,o.a.createElement(b.a,{onClick:function(){i?s():console.log("Sinun t\xe4ytyy kirjautua ennen kuin pelaat")}},"Peli linkin kautta"),n?o.a.createElement("div",null,"Jaa t\xe4m\xe4 linkki kaverillesi. Sen kautta p\xe4\xe4set pelaamaan.","  ",o.a.createElement(_.a,{href:n},n)):null)},ae=n(77),ne=n.n(ae),te=n(94),re=n(125),oe=n.n(re),ie=n(126),ce=n.n(ie),le=n(127),se=n.n(le),ue=n(128),de=n.n(ue),me=n(129),ge=n.n(me),pe=n(130),be=n.n(pe),ve=n(131),fe=n.n(ve),ke=n(132),he=n.n(ke),Ee=n(133),we=n.n(Ee),je=n(134),ye=n.n(je),Oe=n(135),Se=n.n(Oe),Le=n(136),Me=n.n(Le),xe={width:65,height:65,verticalAlign:"middle"},Ie=function(e,a){return"king"===e&&"black"===a?oe.a:"queen"===e&&"black"===a?ce.a:"bishop"===e&&"black"===a?de.a:"rook"===e&&"black"===a?se.a:"knight"===e&&"black"===a?ge.a:"pawn"===e&&"black"===a?be.a:"king"===e&&"white"===a?fe.a:"queen"===e&&"white"===a?he.a:"bishop"===e&&"white"===a?ye.a:"rook"===e&&"white"===a?we.a:"knight"===e&&"white"===a?Se.a:"pawn"===e&&"white"===a?Me.a:void 0},Ne=function(e){var a=e.style,n=e.id,i=e.side,c=e.type,l=Object(r.useState)(1),s=Object(d.a)(l,2),u=s[0],m=s[1];return o.a.createElement("img",{style:Object(t.a)(Object(t.a)({},a),{},{opacity:u}),className:"piece",draggable:"true",onDragStart:function(e){x=e.target,m(.5),console.log("dragged:",x)},onDragEnd:function(e){m(1)},type:n,side:i,id:n,src:Ie(c,i),alt:"sprite"})},Ce=function(e){var a=e.side,n=e.id,r=Object(t.a)({},xe);return o.a.createElement(Ne,{style:r,id:n,side:a,type:"king"},"K")},qe=function(e){var a=e.side,n=e.id,r=Object(t.a)({},xe);return o.a.createElement(Ne,{style:r,id:n,side:a,type:"queen"},"D")},De=function(e){var a=e.side,n=e.id,r=Object(t.a)({},xe);return o.a.createElement(Ne,{style:r,id:n,side:a,type:"rook"},"T")},Ue=function(e){var a=e.side,n=e.id,r=Object(t.a)({},xe);return o.a.createElement(Ne,{style:r,id:n,side:a,type:"knight"},"R")},Pe=function(e){var a=e.side,n=e.id,r=Object(t.a)({},xe);return o.a.createElement(Ne,{style:r,id:n,side:a,type:"bishop"},"L")},$e=function(e){var a=e.side,n=e.id,r=Object(t.a)({},xe);return o.a.createElement(Ne,{style:r,id:n,side:a,type:"pawn"},"S")},Te=function(e){var a=e.color,n=e.makeMove,t=e.location,i=e.piece,c=e.dragHelperMap,l=e.id,s=e.highlight,u=Object(r.useMemo)((function(){return"rgb(".concat("white"===a?"29, 240, 201":"25, 145, 123",")")}),[a]),m=Object(r.useState)(u),g=Object(d.a)(m,2),p=g[0],b=g[1];Object(r.useEffect)((function(){b(s?"rgb(".concat("17, 209, 97",")"):u)}),[s,u]);var v,f={height:70,width:70,backgroundColor:p,textAlign:"center",background:"radial-gradient(".concat(p,", ").concat(u,")")},k=function(){var e=Object(te.a)(ne.a.mark((function e(a){var r,o,i,l;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),r={type:c.get(Number(x.id)).type,side:c.get(Number(x.id)).side},o={row:Math.floor(Number(x.id)/8),column:Number(x.id)%8},i=t,("square"===a.target.className||"piece"===a.target.className)&&b(u),e.prev=5,e.next=8,n({piece:r,oldLocation:o,newLocation:i});case 8:(l=e.sent).data.makeMove.lastMove.success||console.log(l.data.makeMove.lastMove.message),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(a){return e.apply(this,arguments)}}(),h=function(e){("square"===e.target.className||"piece"===e.target.className)&&b("17, 209, 97")},E=function(e){"square"===e.target.className&&"piece"!==e.relatedTarget.className?(e.target.id,b(u)):"piece"===e.target.className&&"square"!==e.relatedTarget.className&&(e.target.parentNode.id,b(u))};if(i)switch(i.type){case"pawn":v=o.a.createElement($e,{side:i.side,id:8*t.row+t.column});break;case"rook":v=o.a.createElement(De,{side:i.side,id:8*t.row+t.column});break;case"knight":v=o.a.createElement(Ue,{side:i.side,id:8*t.row+t.column});break;case"bishop":v=o.a.createElement(Pe,{side:i.side,id:8*t.row+t.column});break;case"queen":v=o.a.createElement(qe,{side:i.side,id:8*t.row+t.column});break;case"king":v=o.a.createElement(Ce,{side:i.side,id:8*t.row+t.column});break;default:v=null}return v?o.a.createElement("td",{id:l,style:f,className:"square",onDragLeave:E,onDragOver:function(e){e.preventDefault()},onDrop:k,onDragEnter:h},v):o.a.createElement("td",{id:l,style:f,className:"square",onDragLeave:E,onDragOver:function(e){e.preventDefault()},onDrop:k,onDragEnter:h})},Qe=function(e){var a=e.boardAlignment,n=e.board,t=e.makeMove,r=e.handleClick,i=e.chosenPiece,c=new Map;n.forEach((function(e,a){e.forEach((function(e,n){c.set(8*a+n,e)}))}));var l=Array.from(Array(8),(function(e,a){for(var n=new Array(8),t=0;t<8;t++)n[t]=(a+t)%2===0?{piece:null,color:"white"}:{piece:null,color:"black"};return n}));return o.a.createElement("table",{className:"board",onClick:r},o.a.createElement("tbody",null,"white"===a?n.map((function(e,a){return o.a.createElement("tr",{key:a},e.map((function(e,n){var r=!1;return i&&(i.availableMoves.forEach((function(e){e.newLocation.row===a&&e.newLocation.column===n&&(r=!0)})),i.location.row===a&&i.location.column===n&&(r=!0)),o.a.createElement(Te,{key:8*a+n,id:8*a+n,color:l[a][n].color,makeMove:t,location:{row:a,column:n},piece:e,dragHelperMap:c,highlight:r})})))})):n.map((function(e,a){return o.a.createElement("tr",{key:a},e.map((function(e,r){var s=!1;return i&&(i.availableMoves.forEach((function(e){e.newLocation.row===7-a&&e.newLocation.column===7-r&&(s=!0)})),i.location.row===7-a&&i.location.column===7-r&&(s=!0)),o.a.createElement(Te,{key:8*(7-a)+(7-r),id:8*(7-a)+(7-r),color:l[7-a][7-r].color,makeMove:t,location:{row:7-a,column:7-r},piece:n[7-a][7-r],dragHelperMap:c,highlight:s})})))}))))},Ge=function(e){var a=e.game,n=a.check,t=a.currentPlayer,r=a.gameOver,i=a.promotionPlayerID,c=a.winner,l=e.promote,s=V(),u=s.user;return s.userLoading?"loading...":o.a.createElement("div",{className:"gameText"},u.id!==t||r?o.a.createElement("div",null,"Odotetaan vastustajan siirtoa. ",n&&n.threatenedPlayer!==u.id?"Shakki!":null):o.a.createElement("h3",null,"On sinun vuorosi. ",n&&n.threatenedPlayer===u.id?"Shakki!":null),o.a.createElement("div",null,u.id===i?o.a.createElement("div",null,"Valitse nappula, joksi haluat muuttaa sotilaan"," ",o.a.createElement(b.a,{onClick:function(){return l("queen")}},"Kuningatar"),o.a.createElement(b.a,{onClick:function(){return l("knight")}},"Ratsu")):null),o.a.createElement("h3",null,r?c===u.id?"Voitit pelin! Onneksi olkoon!":"Ootko paska ku h\xe4visit :D":null))},Ae=function(e){var a=e.squareNode,n=e.pieceToMove,t=e.clickedPiece,r=e.game,o=e.user;return a.style.background!=="radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("25, 145, 123","))")&&a.style.background!=="radial-gradient(rgb(".concat("17, 209, 97","), rgb(").concat("29, 240, 201","))")||t&&t.id===n.id||r.gameOver||r.promotionPlayerID||o.id!==r.currentPlayer},Ke=function(e){var a=e.clickedPiece,n=e.game,t=e.user;return t.id===n.currentPlayer&&a.side===(n.whitePlayer===t.id?"white":"black")&&!n.promotionPlayerID&&!n.gameOver},He=function(){var e=function(){var e=Object(K.a)(),a=Object(s.g)().id,n=function(n){var t=e.readQuery({query:C,variables:{gameId:a}});t={getGame:n.gameStateUpdated},e.writeQuery({query:C,data:t,variables:{id:a}})},t=Object(H.a)(C,{variables:{gameId:a},onError:function(e){R(e)}}),o=Object(A.a)(P),i=Object(d.a)(o,1)[0],c=Object(A.a)(U),l=Object(d.a)(c,1)[0],u=Object(A.a)(D,{variables:{gameId:a},onError:function(e){R(e)},onCompleted:function(e){n(e)}}),m=Object(d.a)(u,1)[0];Object(J.a)(q,{onSubscriptionData:function(e){var a=e.subscriptionData;n(a.data)},variables:{gameId:a}}),Object(r.useEffect)((function(){m()}),[m]);return{game:t.loading||t.error?null:t.data.getGame,gameLoading:t.loading,gameError:t.error,promote:function(e){l({variables:{gameId:a,pieceType:e}})},makeMove:function(e){var n=e.piece,t=e.oldLocation,r=e.newLocation;return i({variables:{move:{piece:n,oldLocation:t,newLocation:r,gameId:a}}})}}}(),a=e.game,n=e.gameLoading,t=e.gameError,i=e.makeMove,c=e.promote,l=V(),u=l.user,m=l.userLoading,g=Object(r.useState)(null),p=Object(d.a)(g,2),b=p[0],v=p[1];if(n||m)return"loading...";if(!a)return t.toString();var f=a.board,k=a.whitePlayer,h=function(){var e=Object(te.a)(ne.a.mark((function e(n){var t,r,o,c,l,s,d,m,g,p,k,h;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),"piece"!==(t=n.target).className){e.next=27;break}if(r=f[Math.floor(Number(t.id)/8)][Number(t.id)%8],!b){e.next=24;break}if(!Ae({squareNode:t.parentNode,pieceToMove:b,clickedPiece:r,user:u,game:a})){e.next=8;break}return v(null),e.abrupt("return");case 8:return o={type:b.type,side:b.side},c={row:b.location.row,column:b.location.column},l={row:r.location.row,column:r.location.column},e.prev=11,e.next=14,i({piece:o,oldLocation:c,newLocation:l});case 14:(s=e.sent).data.makeMove.lastMove.success||console.log(s.data.makeMove.lastMove.message),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),R(e.t0);case 21:v(null),e.next=25;break;case 24:Ke({clickedPiece:r,game:a,user:u})&&v(r);case 25:e.next=54;break;case 27:if("square"!==t.className){e.next=53;break}if((d=t.firstChild)&&(m=f[Math.floor(Number(d.id)/8)][Number(d.id)%8]),!b){e.next=50;break}if(!Ae({squareNode:t,pieceToMove:b,clickedPiece:m,user:u,game:a})){e.next=34;break}return v(null),e.abrupt("return");case 34:return g={type:b.type,side:b.side},p={row:b.location.row,column:b.location.column},k={row:Math.floor(Number(t.id)/8),column:Number(t.id)%8},e.prev=37,e.next=40,i({piece:g,oldLocation:p,newLocation:k});case 40:(h=e.sent).data.makeMove.lastMove.success||console.log(h.data.makeMove.lastMove.message),e.next=47;break;case 44:e.prev=44,e.t1=e.catch(37),R(e.t1);case 47:v(null),e.next=51;break;case 50:m&&Ke({clickedPiece:m,game:a,user:u})&&v(m);case 51:e.next=54;break;case 53:v(null);case 54:case"end":return e.stop()}}),e,null,[[11,18],[37,44]])})));return function(a){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"game"},o.a.createElement("div",null,"Suosittelen nappuloiden liikuttamista klikkaamalla vet\xe4misen sijaan."),o.a.createElement(Qe,{board:f,boardAlignment:u.id===k?"white":"black",makeMove:i,handleClick:h,chosenPiece:b}),o.a.createElement(Ge,{game:a,promote:c}))},Je=function(){var e=V().user;return o.a.createElement("div",null,o.a.createElement(Y,null),e?o.a.createElement(s.c,null,o.a.createElement(s.a,{path:"/play/:id"},o.a.createElement(He,null)),o.a.createElement(s.a,{path:"/play"},o.a.createElement(ee,null)),o.a.createElement(s.a,{path:"/login"},o.a.createElement(z,null)),o.a.createElement(s.a,{path:"/register"},o.a.createElement(Z,null))):"Ladataan...",o.a.createElement(u,null))},Be=n(209),Re=n(66),Ve=n(84),ze=n(85),Fe=n(86),We=n(116),Xe=n(138),Ye=n(137),Ze=n(139),_e=Object(Xe.a)((function(e,a){var n=a.headers,r=sessionStorage.getItem("loggedChessUser");return{headers:Object(t.a)(Object(t.a)({},n),{},{authorization:r?"bearer ".concat(r):null})}})),ea=window.location;I="https:"===ea.protocol?"wss:":"ws:",I+="//"+ea.host,console.log("".concat(I,"/graphql"));var aa=new Re.a({uri:"/graphql"}),na=new Ze.a({uri:"".concat(I,"/graphql"),options:{reconnect:!0}}),ta=Object(Ve.a)((function(e){var a=e.query,n=Object(Ye.a)(a);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),na,_e.concat(aa)),ra=new ze.a({cache:new Fe.a,link:ta,connectToDevTools:!0});c.a.render(o.a.createElement(We.a,{client:ra},o.a.createElement(Be.a,null,o.a.createElement(l.a,null,o.a.createElement(Je,null)))),document.getElementById("root"))}},[[152,1,2]]]);
//# sourceMappingURL=main.ef47fbc5.chunk.js.map